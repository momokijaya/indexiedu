<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>INDEXIEDU Pro - AI Education Assistant</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20640%20512'%3E%3Cpath%20fill='%23667eea'%20d='M320%2032c-17.7%200-32%2014.3-32%2032v16H224c-17.7%200-32%2014.3-32%2032s14.3%2032%2032%2032h64V320H128c-35.3%200-64%2028.7-64%2064s28.7%2064%2064%2064h384c35.3%200%2064-28.7%2064-64s-28.7-64-64-64H352V144h64c17.7%200%2032-14.3%2032-32s-14.3-32-32-32H352V64c0-17.7-14.3-32-32-32zM64%20288c-17.7%200-32%2014.3-32%2032v64c0%2017.7%2014.3%2032%2032%2032H576c17.7%200%2032-14.3%2032-32V320c0-17.7-14.3-32-32-32H64z'/%3E%3C/svg%3E">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            50: '#f0f9ff',
                            100: '#e0f2fe',
                            200: '#bae6fd',
                            300: '#7dd3fc',
                            400: '#38bdf8',
                            500: '#0ea5e9',
                            600: '#0284c7',
                            700: '#0369a1',
                            800: '#075985',
                            900: '#0c4a6e',
                        },
                        accent: {
                            50: '#fef7ff',
                            100: '#fce7ff',
                            200: '#f8d4fe',
                            300: '#f0abfc',
                            400: '#e879f9',
                            500: '#d946ef',
                            600: '#c026d3',
                            700: '#a21caf',
                            800: '#86198f',
                            900: '#701a75',
                        }
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-soft': 'pulse-soft 3s ease-in-out infinite',
                        'shimmer': 'shimmer 2s linear infinite',
                        'bounce-soft': 'bounce-soft 2s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0px)' },
                            '50%': { transform: 'translateY(-10px)' }
                        },
                        'pulse-soft': {
                            '0%, 100%': { opacity: '1' },
                            '50%': { opacity: '0.8' }
                        },
                        shimmer: {
                            '0%': { backgroundPosition: '-200% 0' },
                            '100%': { backgroundPosition: '200% 0' }
                        },
                        'bounce-soft': {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-5px)' }
                        },
                        glow: {
                            '0%': { boxShadow: '0 0 20px rgba(6, 182, 212, 0.3)' },
                            '100%': { boxShadow: '0 0 30px rgba(6, 182, 212, 0.6)' }
                        }
                    }
                }
            }
        }
    </script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=Poppins:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    
    <!-- KaTeX for LaTeX Rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.css" xintegrity="sha384-n8MVd4RsNIU0KOVEMckDITrE3IsidIypkoOkRdflBKoidGbItJpZLomdcAivaxNE" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/katex.min.js" xintegrity="sha384-XjKyOOlVwcpaNlchBQDfuIQA5YNp6gbaQJ5OMrLJQ8zmcITbEwbWgCNl1aGla/A+" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/katex@0.16.9/dist/contrib/auto-render.min.js" xintegrity="sha384-+VBxd3r6XgURycqtZ117nYw44OOcIax56Z4dCRWbxyPt0Koah1uHoK0o4+/RRE05" crossorigin="anonymous"></script>

    <style>
        html { scroll-behavior: smooth; }
        body { font-family: 'Inter', 'Poppins', sans-serif; }

        /* Premium Glass Morphism Effect */
        .glass-effect {
            backdrop-filter: blur(20px);
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
        }

        /* Enhanced Animated Gradient Text */
        .premium-gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 25%, #f093fb 50%, #f5576c 75%, #4facfe 100%);
            background-size: 400% 400%;
            color: transparent;
            -webkit-background-clip: text;
            background-clip: text;
            animation: premium-gradient-flow 4s ease-in-out infinite;
            font-weight: 800;
            letter-spacing: -0.025em;
        }

        @keyframes premium-gradient-flow {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }

        /* Sidebar Styling with Premium Effects */
        .premium-sidebar {
            background: linear-gradient(135deg, #1e293b 0%, #334155 100%);
            box-shadow: 4px 0 24px rgba(0, 0, 0, 0.15);
            scrollbar-width: thin;
            scrollbar-color: #64748b #334155;
        }

        .premium-sidebar-item {
            position: relative;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .premium-sidebar-item::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            width: 0;
            height: 100%;
            background: linear-gradient(90deg, rgba(6, 182, 212, 0.3), rgba(168, 85, 247, 0.3));
            transition: width 0.3s ease;
            z-index: 0;
        }

        .premium-sidebar-item:hover::before {
            width: 100%;
        }

        .premium-sidebar-item.active {
            background: linear-gradient(90deg, rgba(6, 182, 212, 0.2), rgba(168, 85, 247, 0.2));
            color: #06b6d4;
            font-weight: 600;
            border-left: 4px solid #06b6d4;
            box-shadow: 0 4px 12px rgba(6, 182, 212, 0.3);
        }

        .premium-sidebar-item:hover:not(.active) {
            background: rgba(148, 163, 184, 0.1);
            color: white;
            transform: translateX(8px);
        }

        .premium-sidebar-item > * {
            position: relative;
            z-index: 1;
        }

        /* Content Animation */
        .content-section {
            display: none;
        }
        .content-section.active {
            display: block;
            animation: premium-fade-in-up 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        /* Premium Card Styling */
        .premium-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid rgba(226, 232, 240, 0.8);
            border-radius: 20px;
            box-shadow: 
                0 4px 6px -1px rgba(0, 0, 0, 0.1),
                0 2px 4px -1px rgba(0, 0, 0, 0.06),
                0 0 0 1px rgba(255, 255, 255, 0.05);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .premium-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #06b6d4, #8b5cf6, #ec4899);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .premium-card:hover::before {
            transform: scaleX(1);
        }

        .premium-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: 
                0 20px 25px -5px rgba(0, 0, 0, 0.15),
                0 10px 10px -5px rgba(0, 0, 0, 0.1),
                0 0 40px rgba(6, 182, 212, 0.3);
        }

        .premium-feature-card {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid rgba(226, 232, 240, 0.8);
            border-radius: 24px;
            position: relative;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            opacity: 0;
            animation: premium-fade-in-up 0.6s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }

        .premium-feature-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 6px;
            background: linear-gradient(90deg, #06b6d4, #8b5cf6, #ec4899, #f59e0b);
            transform: scaleX(0);
            transition: transform 0.4s ease;
        }

        .premium-feature-card:hover::before {
            transform: scaleX(1);
        }

        .premium-feature-card:hover {
            transform: translateY(-16px) rotateX(5deg);
            box-shadow: 
                0 25px 50px -12px rgba(0, 0, 0, 0.25),
                0 0 60px rgba(6, 182, 212, 0.4);
        }

        .premium-feature-card .icon-container {
            background: linear-gradient(135deg, #06b6d4, #8b5cf6);
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .premium-feature-card .icon-container::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: linear-gradient(45deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: shimmer 2s linear infinite;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .premium-feature-card:hover .icon-container::before {
            opacity: 1;
        }

        .premium-feature-card:hover .icon-container {
            transform: scale(1.1) rotateY(10deg);
            box-shadow: 0 20px 40px rgba(6, 182, 212, 0.4);
        }

        /* Staggered animation delays */
        .premium-feature-card:nth-child(1) { animation-delay: 0.1s; }
        .premium-feature-card:nth-child(2) { animation-delay: 0.15s; }
        .premium-feature-card:nth-child(3) { animation-delay: 0.2s; }
        .premium-feature-card:nth-child(4) { animation-delay: 0.25s; }
        .premium-feature-card:nth-child(5) { animation-delay: 0.3s; }
        .premium-feature-card:nth-child(6) { animation-delay: 0.35s; }
        .premium-feature-card:nth-child(7) { animation-delay: 0.4s; }
        .premium-feature-card:nth-child(8) { animation-delay: 0.45s; }
        .premium-feature-card:nth-child(9) { animation-delay: 0.5s; }
        .premium-feature-card:nth-child(10) { animation-delay: 0.55s; }
        .premium-feature-card:nth-child(11) { animation-delay: 0.6s; }
        .premium-feature-card:nth-child(12) { animation-delay: 0.65s; }

        /* Premium Button Styling */
        .premium-button {
            background: linear-gradient(135deg, #06b6d4 0%, #8b5cf6 100%);
            border: none;
            border-radius: 16px;
            color: white;
            font-weight: 700;
            padding: 16px 32px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 8px 25px rgba(6, 182, 212, 0.3);
        }

        .premium-button::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
            transition: left 0.5s ease;
        }

        .premium-button:hover::before {
            left: 100%;
        }

        .premium-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 35px rgba(6, 182, 212, 0.4);
            background: linear-gradient(135deg, #0891b2 0%, #7c3aed 100%);
        }

        .premium-button:active {
            transform: translateY(1px);
        }

        /* Enhanced Loader */
        .premium-loader {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(6, 182, 212, 0.2);
            border-top: 4px solid #06b6d4;
            border-radius: 50%;
            animation: premium-spin 1s cubic-bezier(0.68, -0.55, 0.265, 1.55) infinite;
            position: relative;
        }

        .premium-loader::before {
            content: '';
            position: absolute;
            top: -4px;
            left: -4px;
            right: -4px;
            bottom: -4px;
            border: 4px solid transparent;
            border-top: 4px solid rgba(139, 92, 246, 0.6);
            border-radius: 50%;
            animation: premium-spin 1.5s linear infinite reverse;
        }

        /* Premium Form Styling */
        .premium-input, .premium-textarea, .premium-select {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border: 2px solid #e2e8f0;
            border-radius: 12px;
            padding: 12px 16px;
            font-size: 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.05);
        }

        .premium-input:focus, .premium-textarea:focus, .premium-select:focus {
            outline: none;
            border-color: #06b6d4;
            box-shadow: 
                0 0 0 4px rgba(6, 182, 212, 0.1),
                inset 0 2px 4px rgba(0, 0, 0, 0.05);
            transform: translateY(-1px);
        }

        /* AI Output Styling */
        .premium-ai-output {
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
            border-radius: 20px;
            padding: 20px;
            line-height: 1.8;
            color: #334155;
            box-shadow: 
                inset 0 2px 4px rgba(0, 0, 0, 0.06),
                0 4px 12px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        @media (min-width: 768px) {
            .premium-ai-output {
                padding: 32px;
            }
        }

        .premium-ai-output::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, #06b6d4, #8b5cf6, #ec4899, #f59e0b);
            border-radius: 20px 20px 0 0;
        }

        .premium-ai-output h2 {
            font-size: 1.5rem;
            font-weight: 800;
            margin-bottom: 1.5rem;
            padding-bottom: 0.75rem;
            background: linear-gradient(135deg, #06b6d4, #8b5cf6);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            border-bottom: 3px solid #e2e8f0;
        }

        .premium-ai-output h3 {
            font-size: 1.25rem;
            font-weight: 700;
            margin: 1.5rem 0 1rem;
            color: #1e293b;
        }

        .premium-ai-output h4 {
            font-size: 1.1rem;
            font-weight: 600;
            margin: 1rem 0 0.5rem;
            color: #475569;
        }

        /* Tab System Fix & Styling */
        .tab-content, .tab-content-nested {
            display: none;
        }
        .tab-content.active, .tab-content-nested.active {
            display: block;
            animation: premium-fade-in-up 0.5s cubic-bezier(0.4, 0, 0.2, 1) forwards;
        }
        .premium-tab-button {
            background: transparent;
            border: none;
            border-bottom: 3px solid transparent;
            color: #64748b;
            font-weight: 600;
            padding: 10px 16px;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        .premium-tab-button::before {
            content: '';
            position: absolute;
            bottom: -3px;
            left: 0;
            width: 0;
            height: 3px;
            background: linear-gradient(90deg, #06b6d4, #8b5cf6);
            transition: width 0.3s ease;
        }

        .premium-tab-button.active {
            color: #06b6d4;
        }

        .premium-tab-button.active::before {
            width: 100%;
        }

        .premium-tab-button:hover:not(.active) {
            color: #1e293b;
            background: rgba(6, 182, 212, 0.05);
            border-radius: 8px 8px 0 0;
        }

        /* Background Pattern */
        .premium-bg-pattern {
            background-image: 
                radial-gradient(circle at 25% 25%, rgba(6, 182, 212, 0.05) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.05) 0%, transparent 50%);
        }

        /* File Upload Styling */
        .premium-file-upload {
            border: 2px dashed #cbd5e1;
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            background: linear-gradient(145deg, #ffffff 0%, #f8fafc 100%);
        }

        .premium-file-upload:hover {
            border-color: #06b6d4;
            background: linear-gradient(145deg, #f0f9ff 0%, #e0f2fe 100%);
        }

        /* Premium Animations */
        @keyframes premium-fade-in-up {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes premium-spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
            100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
        }

        /* Mobile Responsive Enhancements */
        @media (max-width: 768px) {
            .premium-feature-card {
                margin-bottom: 16px;
            }
            
            .premium-feature-card:hover {
                transform: translateY(-8px);
            }
            
            .premium-ai-output {
                padding: 20px;
            }
        }

        /* Math/LaTeX Styling */
        .premium-ai-output .katex-display {
            display: block;
            overflow-x: auto;
            overflow-y: hidden;
            padding: 20px;
            margin: 20px 0;
            background: linear-gradient(145deg, #f1f5f9, #e2e8f0);
            border-left: 6px solid #06b6d4;
            border-radius: 12px;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .premium-ai-output .katex {
            font-size: 1.25rem;
            color: #1e40af;
        }

        /* Enhanced Mobile Header */
        .premium-mobile-header {
            background: linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.95) 100%);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(226, 232, 240, 0.8);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
        }

        /* Floating Action Elements */
        .floating-element {
            animation: float 6s ease-in-out infinite;
        }

        /* Success/Error States */
        .success-state {
            background: linear-gradient(135deg, #d1fae5, #a7f3d0);
            border: 1px solid #6ee7b7;
            color: #065f46;
        }

        .error-state {
            background: linear-gradient(135deg, #fee2e2, #fecaca);
            border: 1px solid #f87171;
            color: #991b1b;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-slate-50 via-blue-50 to-indigo-50 text-slate-800 overflow-hidden premium-bg-pattern">

    <div class="relative flex h-screen">
        <!-- Backdrop for mobile sidebar -->
        <div id="sidebar-backdrop" class="fixed inset-0 bg-black bg-opacity-60 z-30 hidden md:hidden backdrop-blur-sm"></div>

        <!-- Premium Sidebar -->
        <aside id="sidebar" class="w-72 premium-sidebar text-slate-200 flex flex-col h-full fixed inset-y-0 left-0 z-40 transform -translate-x-full transition-all duration-500 ease-in-out md:relative md:translate-x-0">
            <div class="p-6 border-b border-slate-600/30 flex-shrink-0 relative">
                <button id="sidebar-close-btn" class="absolute top-6 right-6 text-slate-400 hover:text-white md:hidden z-50 transition-colors duration-200">
                    <i class="fas fa-times text-2xl"></i>
                </button>
                <div class="flex flex-col items-center text-center">
                    <a href="#" id="home-link-desktop" class="cursor-pointer group">
                        <h1 class="text-4xl font-black mb-4 group-hover:scale-105 transition-transform duration-300">
                            <span class="premium-gradient-text">INDEXIEDU</span>
                        </h1>
                        <div class="text-sm text-slate-300 bg-gradient-to-r from-cyan-400/20 to-purple-400/20 px-3 py-1 rounded-full border border-slate-500/30 inline-block mb-4">
                            <i class="fas fa-crown text-yellow-400 mr-2"></i>Professional Edition
                        </div>
                    </a>
                    <div class="flex items-center glass-effect rounded-2xl p-4 w-full">
                        <div class="w-12 h-12 rounded-xl bg-gradient-to-br from-cyan-400 to-purple-500 flex items-center justify-center floating-element">
                            <i class="fas fa-graduation-cap text-2xl text-white"></i>
                        </div>
                        <div class="ml-4 text-left">
                            <p class="text-white font-semibold text-lg leading-tight">Asisten Guru Digital</p>
                            <p class="text-slate-300 text-sm leading-tight">Powered by Advanced AI</p>
                        </div>
                    </div>
                </div>
            </div>
            <nav class="flex-1 p-3 space-y-2 overflow-y-auto">
                <a href="#" class="premium-sidebar-item active flex items-center py-4 px-5 rounded-xl" data-target="home">
                    <i class="fas fa-home w-6 text-center text-xl"></i>
                    <span class="ml-4 font-semibold">Beranda</span>
                </a>
                
                <div class="pt-6 pb-3">
                    <p class="px-5 text-xs font-bold text-slate-400 uppercase tracking-wider">Pembuatan Materi</p>
                </div>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="generator-materi">
                    <i class="fas fa-book-open w-6 text-center text-xl"></i><span class="ml-4 font-medium">Generator Materi</span>
                </a>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="generator-glosarium">
                    <i class="fas fa-spell-check w-6 text-center text-xl"></i><span class="ml-4 font-medium">Generator Glosarium</span>
                </a>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="konteks-visual">
                    <i class="fas fa-image w-6 text-center text-xl"></i><span class="ml-4 font-medium">Konteks Visual Cerdas</span>
                </a>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="pembuat-soal">
                    <i class="fas fa-lightbulb w-6 text-center text-xl"></i><span class="ml-4 font-medium">Pembuat Soal</span>
                </a>

                <div class="pt-6 pb-3">
                    <p class="px-5 text-xs font-bold text-slate-400 uppercase tracking-wider">Pelaksanaan Pembelajaran</p>
                </div>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="penjawab-soal">
                    <i class="fas fa-calculator w-6 text-center text-xl"></i><span class="ml-4 font-medium">Penjawab Soal Cerdas</span>
                </a>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="perancang-proyek">
                    <i class="fas fa-sitemap w-6 text-center text-xl"></i><span class="ml-4 font-medium">Perancang Proyek (PBL)</span>
                </a>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="pustaka-aktivitas">
                    <i class="fas fa-users w-6 text-center text-xl"></i><span class="ml-4 font-medium">Pustaka Aktivitas</span>
                </a>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="pembuat-kuis">
                    <i class="fas fa-graduation-cap w-6 text-center text-xl"></i><span class="ml-4 font-medium">Pembuat Kuis Cepat</span>
                </a>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="asisten-pertanyaan">
                    <i class="fas fa-question-circle w-6 text-center text-xl"></i><span class="ml-4 font-medium">Asisten Pertanyaan</span>
                </a>

                <div class="pt-6 pb-3">
                    <p class="px-5 text-xs font-bold text-slate-400 uppercase tracking-wider">Evaluasi & Administrasi</p>
                </div>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="penilaian-otomatis">
                    <i class="fas fa-check-double w-6 text-center text-xl"></i><span class="ml-4 font-medium">Pengecekan & Penilaian AI</span>
                </a>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="perencana-rpp">
                    <i class="fas fa-file-alt w-6 text-center text-xl"></i><span class="ml-4 font-medium">Perencana & Analisis RPP</span>
                </a>
                <a href="#" class="premium-sidebar-item flex items-center py-4 px-5 rounded-xl" data-target="komunikasi-ortu">
                    <i class="fas fa-envelope w-6 text-center text-xl"></i><span class="ml-4 font-medium">Komunikasi Orang Tua</span>
                </a>
            </nav>
            <div class="p-6 border-t border-slate-600/30 text-xs flex-shrink-0 text-slate-400 text-center">
                <div class="glass-effect rounded-xl p-4">
                    <p class="font-semibold">&copy; 2025 INDEXIEDU Professional</p>
                    <p class="text-slate-500">Developed with AI Excellence</p>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col min-w-0">
            <!-- Mobile Header -->
            <header class="md:hidden flex items-center justify-between premium-mobile-header p-4 sticky top-0 z-20">
                <button id="menu-toggle" class="text-slate-700 hover:text-primary-600 p-2 rounded-lg transition-colors">
                    <i class="fas fa-bars text-xl"></i>
                </button>
                <a href="#" id="home-link-mobile" class="cursor-pointer">
                    <h1 class="text-2xl font-black premium-gradient-text">INDEXIEDU</h1>
                </a>
                <div class="w-8"></div>
            </header>

            <main class="flex-1 p-3 sm:p-6 md:p-8 overflow-y-auto">

                <!-- Premium Homepage -->
                <section id="home" class="content-section active">
                    <div class="max-w-7xl mx-auto">
                        <div class="text-center mb-12">
                            <h1 class="text-2xl sm:text-4xl md:text-5xl font-black text-slate-900 mb-6 leading-tight">
                                Selamat Datang, <span class="premium-gradient-text">Pendidik Profesional!</span>
                            </h1>
                            <p class="text-base sm:text-lg text-slate-600 mb-8 max-w-4xl mx-auto leading-relaxed">
                                Platform AI terdepan untuk transformasi pengajaran modern. Semua perangkat canggih Anda dalam satu tempat yang elegan dan powerful.
                            </p>
                            <div class="flex flex-wrap items-center justify-center gap-2 sm:gap-4 mb-8">
                                <div class="flex items-center bg-green-100 text-green-800 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full text-sm sm:text-base">
                                    <i class="fas fa-check-circle mr-2"></i>
                                    <span class="font-semibold">50+ AI Tools</span>
                                </div>
                                <div class="flex items-center bg-blue-100 text-blue-800 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full text-sm sm:text-base">
                                    <i class="fas fa-bolt mr-2"></i>
                                    <span class="font-semibold">Instant Results</span>
                                </div>
                                <div class="flex items-center bg-purple-100 text-purple-800 px-3 py-1.5 sm:px-4 sm:py-2 rounded-full text-sm sm:text-base">
                                    <i class="fas fa-shield-alt mr-2"></i>
                                    <span class="font-semibold">100% Secure</span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 md:gap-8">
                            <!-- Premium Feature Cards -->
                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="generator-materi">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-book-open text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Generator Materi</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Buat materi ajar berkualitas tinggi dari topik kurikulum atau ide kustom Anda dengan AI terdepan.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="generator-glosarium">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-spell-check text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Generator Glosarium</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Ekstrak dan jelaskan istilah kunci dari materi bacaan dengan analisis konteks mendalam.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="konteks-visual">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-image text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Konteks Visual</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Analisis gambar untuk bahan diskusi dan pertanyaan HOTS dengan computer vision canggih.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="pembuat-soal">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-lightbulb text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Pembuat Soal</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Rancang soal berkualitas dengan pembahasan rinci secara otomatis dan terstruktur.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="penjawab-soal">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-calculator text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Penjawab Soal Cerdas</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Dapatkan solusi dan pembahasan lengkap untuk soal teks atau gambar dengan akurasi tinggi.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="perancang-proyek">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-sitemap text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Perancang Proyek (PBL)</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Susun kerangka kerja proyek pembelajaran yang terstruktur dan inovatif.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="pustaka-aktivitas">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-users text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Pustaka Aktivitas</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Temukan ide aktivitas kelas yang interaktif dan menarik untuk semua tingkatan.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="pembuat-kuis">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-graduation-cap text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Pembuat Kuis Cepat</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Buat kuis formatif dengan beragam tipe soal secara instan dan profesional.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="asisten-pertanyaan">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-question-circle text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Asisten Pertanyaan</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Dapatkan ide kreatif untuk menjawab pertanyaan sulit dari siswa dengan mudah.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="penilaian-otomatis">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-magic text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Penilaian AI Otomatis</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Periksa lembar jawaban pilihan ganda & esai secara instan dengan akurasi tinggi.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="perencana-rpp">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-file-alt text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Perencana & Analisis RPP</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Buat draf atau dapatkan umpan balik profesional untuk RPP Anda dengan AI.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>

                            <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group" data-target="komunikasi-ortu">
                                <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                    <i class="fas fa-envelope text-xl sm:text-2xl text-white"></i>
                                </div>
                                <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">Komunikasi Orang Tua</h3>
                                <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Buat draf pesan profesional untuk orang tua/wali siswa dengan tone yang tepat.</p>
                                <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                    <span>Mulai Sekarang</span>
                                    <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                                </div>
                            </div>
                        </div>

                        <!-- Premium Stats Section -->
                        <div class="mt-16 grid grid-cols-2 md:grid-cols-4 gap-8">
                            <div class="text-center">
                                <div class="text-2xl sm:text-3xl font-black text-primary-600 mb-2">50k+</div>
                                <div class="text-slate-600 font-semibold">Guru Aktif</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl sm:text-3xl font-black text-primary-600 mb-2">1M+</div>
                                <div class="text-slate-600 font-semibold">Materi Dibuat</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl sm:text-3xl font-black text-primary-600 mb-2">99.9%</div>
                                <div class="text-slate-600 font-semibold">Uptime</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl sm:text-3xl font-black text-primary-600 mb-2">24/7</div>
                                <div class="text-slate-600 font-semibold">Support</div>
                            </div>
                        </div>
                    </div>
                </section>
                
                <!-- Dynamic Content Sections -->
                <section id="generator-materi" class="content-section"></section>
                <section id="generator-glosarium" class="content-section"></section>
                <section id="konteks-visual" class="content-section"></section>
                <section id="pembuat-soal" class="content-section"></section>
                <section id="penjawab-soal" class="content-section"></section>
                <section id="perancang-proyek" class="content-section"></section>
                <section id="pustaka-aktivitas" class="content-section"></section>
                <section id="pembuat-kuis" class="content-section"></section>
                <section id="asisten-pertanyaan" class="content-section"></section>
                <section id="perencana-rpp" class="content-section"></section>
                <section id="penilaian-otomatis" class="content-section"></section>
                <section id="komunikasi-ortu" class="content-section"></section>

            </main>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // --- Mobile Sidebar Toggle ---
            const sidebar = document.getElementById('sidebar');
            const menuToggle = document.getElementById('menu-toggle');
            const sidebarBackdrop = document.getElementById('sidebar-backdrop');
            const sidebarCloseBtn = document.getElementById('sidebar-close-btn');
            
            function openSidebar() {
                sidebar.classList.remove('-translate-x-full');
                sidebarBackdrop.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }

            function closeSidebar() {
                sidebar.classList.add('-translate-x-full');
                sidebarBackdrop.classList.add('hidden');
                document.body.style.overflow = '';
            }

            if (menuToggle && sidebar && sidebarBackdrop) {
                menuToggle.addEventListener('click', (e) => {
                    e.stopPropagation();
                    openSidebar();
                });
                
                sidebarBackdrop.addEventListener('click', closeSidebar);
                
                if (sidebarCloseBtn) {
                    sidebarCloseBtn.addEventListener('click', closeSidebar);
                }

                document.addEventListener('keydown', (e) => {
                    if (e.key === 'Escape' && !sidebar.classList.contains('-translate-x-full')) {
                        closeSidebar();
                    }
                });
            }

            // --- API Key Management (Same as original) ---
            const apiKeys = [
                'AIzaSyDE-eC4Z5sLoyLb-gfufWybfq5FDfQ8eJA', 'AIzaSyCJCLcOLSxNzAo7Yj2OkFrvBCmriMWWY4A', 'AIzaSyBCN3QCP0JAlh8T0A4I_bnYO8dRJaxgllc',
                'AIzaSyB7ZflQgfuCdAwCdJqy5ls1mGoVQCK0Ghg', 'AIzaSyBk5rAPyic400shgKO1PAAPJYbnoYj7IqA', 'AIzaSyCEgpllq7leaQTBVE-f75plyvxVGR5W_ao',
                'AIzaSyALljReS1FmyIo97G8jTSrsxzg_Cso17Cg', 'AIzaSyD5Pnxdj4ZOAr3xAd6BiaO4IG8SG0nWGp4', 'AIzaSyDKnnXW9NA7uyMMAVG9uYUvJ4hxqcDi6_o',
                'AIzaSyChFUV-BPSFJ7poTCVR0Cxy9L8ds4Ldiww', 'AIzaSyBiJPu2xcdgwLid7qmTE4jo4kz3Z0KdVwo', 'AIzaSyBm7ybTjettHpMpOXC44RFuugTvSL9AfyM',
                'AIzaSyDkFafHvNqvVtpKhNkXVe1OauD2-fToTzI', 'AIzaSyAy67NvK3oXQlYeuHsxeZKZGZyhpS4sUIY', 'AIzaSyDqAcC5A-BCl9Jx_Phf00TSChtQsbXEdrk',
                'AIzaSyBx-6s73J21nC26BUpANly7JumBdoI9xIQ', 'AIzaSyBVKX4N-G5N_A6HJBkPYPJtuNUu71QJH00', 'AIzaSyD8Wp9dObil7_0s0H245qWI7WAboQkjdN0',
                'AIzaSyCfJqiEAATvUm0W8ObytHcVVnbfzYxtjgI', 'AIzaSyCvPrjP0JDJI5MG6fOUp4aNhcp4I_ECZRc', 'AIzaSyBvr68vnrqULhtNVZL1qAbuO5plpKH3FAk',
                'AIzaSyDb4-TEf5XpEgccDzT-ljW1-3WMAKIueI4', 'AIzaSyDn2GIW4umXSQlHqr93zr4SY_EiQ_wdPfA', 'AIzaSyCm6enRK31KfDv14xEy_DJlSBnqq0Azh_E',
                'AIzaSyDIhc8O1ZUgiNACedX042xcAm923lJlpQQ', 'AIzaSyC39ZdFoP_dL2lMCxd4toHKSiCNa6TjwLg', 'AIzaSyDH8KTnWkaC16PQzI4MCy6zN7WkDpBEKDA',
                'AIzaSyB3dWuBMb0qteIP4L6Nb6KCyBZRcKIVem8', 'AIzaSyBB5gMx6G0R02L5a2ebYlIYOwn7paZyiTM', 'AIzaSyC5a5nVr2Xl3g27CzEkM4cxDcRj18QEikw',
                'AIzaSyB9rj_61pBwo-i3o75cAlqTbNkJg55_mH4', 'AIzaSyDdhxFL_c-ng0nE2gohhnQYNZo6pDC68hc', 'AIzaSyAB3Xciz90acmlT2aaJKILGEv855ol6OAA',
                'AIzaSyCbjoknzlVgBhAllzP0bI4mLxIgJReKg6s', 'AIzaSyDxedzgoLaeH6HrH2lIGpEdy-SCW1a9KGU', 'AIzaSyCMhvZvu9xaCii5lLGJ4ZOwxrhp898qStE',
                'AIzaSyD7Q7oHvp2cizaCG8I2mvEN70_yBD8Y7Ew', 'AIzaSyAASnZpn_TOkHCqzUppJ1EdLIVLiOPYsGI', 'AIzaSyDM0YxVpninfgvtXyP0m_6WfIfAFOBmqno',
                'AIzaSyAnH3M3OO7ecyVghLFkZqH53cQM-R-pOL0', 'AIzaSyBQZxg7_o_7EX6UCmX8dwTIDJUH6APCkXk', 'AIzaSyA7YQoKMTjz4LAUhjGwOySArHJXp1HikVk',
                'AIzaSyBoOhUdRm8N4eHg4SZbZsPqddyBpyqfWxs', 'AIzaSyBB5nBm3oGH9ave0Ix8l6i6S7K-p-cDooQ', 'AIzaSyDC_xfL0rS38CVyPjjpf72HakG3r5qLrlM',
                'AIzaSyBO0jGyOHa1N926svN5k-t_l79r7Kx5jtU', 'AIzaSyBAx8MajsvGrcCbQ4uU-H_5vOWsppqMB-A', 'AIzaSyCOffgp57pdF0YStr6hx9ebRMsGNF-xVac',
                'AIzaSyBZ9DmnBWIhICwFS4rgfEAgVOWKQTvsDco', 'AIzaSyAYCj1fUO_6rKT2UgHi6Y6ITtXYFP9lcEQ', 'AIzaSyDHa1GwBT_-d40Ug5S_HGQ4fPPcsCF5HoI'
            ];
            
            let currentApiKeyIndex = parseInt(localStorage.getItem('currentApiKeyIndex')) || 0;

            function getNextApiKey() {
                const key = apiKeys[currentApiKeyIndex];
                currentApiKeyIndex = (currentApiKeyIndex + 1) % apiKeys.length;
                localStorage.setItem('currentApiKeyIndex', currentApiKeyIndex);
                let usedIndex = currentApiKeyIndex === 0 ? apiKeys.length - 1 : currentApiKeyIndex - 1;
                console.log(`Using API Key at index: ${usedIndex}`);
                return key;
            }

            // --- Curriculum Database (Same as original) ---
            const kurikulumData = {
                "TK": { "Kelompok A (4-5 Tahun)": { "Tematik": ["Diri Sendiri", "Lingkunganku", "Kebutuhanku", "Binatang", "Tanaman", "Alam Semesta"] }, "Kelompok B (5-6 Tahun)": { "Tematik": ["Keluarga, Sekolah, Masyarakat", "Pekerjaan", "Air, Udara, Api", "Alat Komunikasi", "Tanah Airku", "Gejala Alam"] } },
                "SD": { "Kelas 1": { "Pendidikan Pancasila": ["Simbol dan Sila Pancasila", "Aturan di Rumah dan Sekolah", "Menjaga Kebersihan Lingkungan"], "Bahasa Indonesia": ["Mengenal Huruf dan Suku Kata", "Membaca Kalimat Sederhana", "Menulis Nama Diri dan Objek"], "Matematika": ["Membilang Angka 1-20", "Penjumlahan dan Pengurangan Sederhana", "Mengenal Bangun Datar"] }, "Kelas 2": { "Pendidikan Pancasila": ["Hidup Rukun", "Sikap Sesuai Sila Pancasila", "Tata Tertib dan Aturan"], "Bahasa Indonesia": ["Kata Sapaan dan Kalimat Tanya", "Puisi Anak", "Membaca Dongeng"], "Matematika": ["Bilangan sampai 500", "Perkalian dan Pembagian Dasar", "Satuan Waktu (Jam) dan Panjang (cm, m)"] }, "Kelas 3": { "Pendidikan Pancasila": ["Makna Sumpah Pemuda", "Keberagaman Karakteristik Individu", "Hak dan Kewajiban di Rumah dan Sekolah"], "Bahasa Indonesia": ["Ciri-ciri Makhluk Hidup", "Perkembangan Teknologi Produksi", "Surat untuk Teman"], "Matematika": ["Operasi Hitung Campuran", "Pecahan Sederhana", "Luas dan Keliling Persegi dan Persegi Panjang"] }, "Kelas 4": { "Pendidikan Pancasila": ["Makna Sila-Sila Pancasila", "Hak dan Kewajiban sebagai Warga", "Keberagaman Suku dan Budaya"], "Bahasa Indonesia": ["Ide Pokok dan Kalimat Utama", "Teks Petunjuk Penggunaan", "Teks Deskripsi dan Narasi"], "Matematika": ["Bilangan Cacah Besar", "FPB dan KPK", "Pecahan", "Bangun Datar", "Statistika (Diagram Batang)"], "IPAS": ["Bagian Tumbuhan dan Fungsinya", "Wujud Zat", "Gaya dan Pengaruhnya", "Energi dan Perubahannya"] }, "Kelas 5": { "Pendidikan Pancasila": ["Gotong Royong", "Keberagaman Suku, Agama, dan Budaya", "Cinta Tanah Air"], "Bahasa Indonesia": ["Iklan Media Cetak dan Elektronik", "Teks Narasi Sejarah", "Surat Undangan"], "Matematika": ["Operasi Hitung Pecahan", "Kecepatan dan Debit", "Skala", "Volume Kubus dan Balok"], "IPAS": ["Sistem Organ Manusia", "Ekosistem dan Rantai Makanan", "Siklus Air", "Sistem Tata Surya"] }, "Kelas 6": { "Pendidikan Pancasila": ["Penerapan Nilai-nilai Pancasila", "Sistem Pemerintahan", "Peran Indonesia di ASEAN"], "Bahasa Indonesia": ["Teks Laporan Hasil Pengamatan", "Menyampaikan Pidato", "Mengisi Formulir"], "Matematika": ["Bilangan Bulat", "Lingkaran", "Bangun Ruang Campuran", "Statistika (Mean, Median, Modus)"], "IPAS": ["Perkembangbiakan Makhluk Hidup", "Pubertas", "Listrik dan Magnet", "Gerhana"] } },
                "SMP": { "Kelas 7": { "Pendidikan Pancasila": ["Sejarah Perumusan Pancasila", "Norma dan Keadilan", "Keberagaman dalam Bingkai Bhinneka Tunggal Ika"], "Bahasa Indonesia": ["Teks Deskripsi", "Teks Cerita Fantasi", "Teks Prosedur", "Surat Pribadi dan Surat Dinas"], "Matematika": ["Bilangan", "Himpunan", "Bentuk Aljabar", "Persamaan dan Pertidaksamaan Linear Satu Variabel"], "IPA": ["Objek IPA dan Pengamatannya", "Klasifikasi Makhluk Hidup", "Suhu dan Kalor", "Energi dalam Sistem Kehidupan"], "IPS": ["Manusia, Tempat, dan Lingkungan", "Interaksi Sosial", "Kegiatan Ekonomi", "Masa Praaksara, Hindu-Buddha, dan Islam"], "Bahasa Inggris": ["Greeting and Introduction", "Describing People", "Telling Time, Day, and Date"] }, "Kelas 8": { "Pendidikan Pancasila": ["Kedudukan dan Fungsi Pancasila", "Menumbuhkan Kesadaran terhadap UUD 1945", "Semangat Kebangkitan Nasional 1908"], "Bahasa Indonesia": ["Teks Berita", "Iklan, Slogan, dan Poster", "Teks Eksplanasi", "Teks Ulasan/Resensi"], "Matematika": ["Pola Bilangan", "Sistem Koordinat", "Relasi dan Fungsi", "Persamaan Garis Lurus", "Teorema Pythagoras", "Lingkaran"], "IPA": ["Gerak Benda dan Makhluk Hidup", "Pesawat Sederhana", "Sistem Pencernaan Manusia", "Getaran, Gelombang, dan Bunyi", "Cahaya dan Alat Optik"], "IPS": ["Pengaruh Interaksi Sosial", "Perdagangan Antardaerah", "Kolonialisme dan Imperialisme Barat"], "Bahasa Inggris": ["Asking for and Giving Opinion", "Simple Past Tense", "Recount Text"] }, "Kelas 9": { "Pendidikan Pancasila": ["Dinamika Perwujudan Pancasila", "Kedaulatan Negara Kesatuan Republik Indonesia", "Bela Negara"], "Bahasa Indonesia": ["Teks Laporan Percobaan", "Teks Pidato Persuasif", "Teks Cerpen", "Teks Tanggapan"], "Matematika": ["Bilangan Berpangkat dan Bentuk Akar", "Persamaan Kuadrat", "Fungsi Kuadrat", "Transformasi Geometri", "Bangun Ruang Sisi Lengkung"], "IPA": ["Sistem Reproduksi", "Pewarisan Sifat", "Listrik Statis dan Dinamis", "Kemagnetan", "Bioteknologi"], "IPS": ["Perubahan Sosial Budaya dan Globalisasi", "Perdagangan Internasional", "Sejarah Masa Kemerdekaan hingga Reformasi"], "Bahasa Inggris": ["Procedure Text", "Report Text", "Narrative Text"] } },
                "SMA": { "Kelas 10": { "Pendidikan Pancasila": ["Pancasila dalam Konteks Sejarah", "Lembaga-lembaga Negara", "Warga Negara Indonesia"], "Bahasa Indonesia": ["Teks Laporan Hasil Observasi", "Teks Eksposisi", "Teks Anekdot", "Debat"], "Matematika Wajib": ["Persamaan Nilai Mutlak", "Sistem Persamaan Linear Tiga Variabel", "Fungsi", "Trigonometri Dasar"], "Sejarah Indonesia": ["Konsep Berpikir Sejarah", "Manusia Purba di Indonesia", "Kerajaan Hindu-Buddha dan Islam"], "Biologi": ["Ruang Lingkup Biologi", "Keanekaragaman Hayati", "Virus, Bakteri, Protista, Fungi"], "Fisika": ["Pengukuran dan Vektor", "Gerak Lurus dan Parabola", "Dinamika Partikel (Hukum Newton)"], "Kimia": ["Hakikat Ilmu Kimia", "Struktur Atom dan Sistem Periodik", "Ikatan Kimia"], "Geografi": ["Dasar Geografi dan Pemetaan", "Litosfer dan Pedosfer", "Atmosfer", "Hidrosfer"], "Ekonomi": ["Konsep Dasar Ilmu Ekonomi", "Masalah dan Sistem Ekonomi", "Permintaan dan Penawaran"], "Sosiologi": ["Fungsi Sosiologi", "Individu, Kelompok, dan Hubungan Sosial"] }, "Kelas 11": { "Pendidikan Pancasila": ["Harmonisasi Hak dan Kewajiban Asasi Manusia", "Sistem Demokrasi Pancasila", "Ancaman terhadap Negara"], "Bahasa Indonesia": ["Teks Prosedur", "Teks Eksplanasi", "Teks Ceramah", "Karya Ilmiah"], "Matematika Wajib": ["Program Linear", "Matriks", "Transformasi Geometri", "Limit dan Turunan Fungsi Aljabar"], "Sejarah Indonesia": ["Kolonialisme dan Imperialisme", "Pergerakan Nasional", "Pendudukan Jepang dan Proklamasi"], "Biologi": ["Sel", "Jaringan Tumbuhan dan Hewan", "Sistem Organ Manusia (Gerak, Sirkulasi, Pencernaan, dll.)"], "Fisika": ["Dinamika Rotasi", "Fluida", "Suhu dan Kalor", "Termodinamika", "Gelombang"], "Kimia": ["Hidrokarbon dan Minyak Bumi", "Termokimia", "Laju Reaksi", "Kesetimbangan Kimia", "Larutan Asam Basa"], "Geografi": ["Biosfer", "Antroposfer", "Sumber Daya Alam", "Ketahanan Pangan"], "Ekonomi": ["Pendapatan Nasional", "Pertumbuhan Ekonomi", "Ketenagakerjaan", "Inflasi", "Kebijakan Moneter dan Fiskal"], "Sosiologi": ["Kelompok Sosial", "Permasalahan Sosial", "Perbedaan dan Kesetaraan", "Konflik dan Integrasi"] }, "Kelas 12": { "Pendidikan Pancasila": ["Kasus Pelanggaran Hak", "Peran Pers", "Peran Indonesia dalam Perdamaian Dunia"], "Bahasa Indonesia": ["Surat Lamaran Pekerjaan", "Teks Cerita Sejarah", "Teks Editorial", "Kritik dan Esai"], "Matematika Wajib": ["Geometri Ruang (Dimensi Tiga)", "Statistika Inferensial", "Kaidah Pencacahan", "Peluang"], "Sejarah Indonesia": ["Perjuangan Pasca Kemerdekaan", "Demokrasi Liberal dan Terpimpin", "Orde Baru dan Reformasi"], "Biologi": ["Pertumbuhan dan Perkembangan", "Metabolisme Sel", "Genetika dan Hereditas", "Evolusi", "Bioteknologi"], "Fisika": ["Listrik Arus Searah dan Bolak-balik", "Medan Magnet", "Fisika Kuantum", "Fisika Inti"], "Kimia": ["Sifat Koligatif Larutan", "Elektrokimia", "Kimia Unsur", "Senyawa Karbon", "Makromolekul"], "Geografi": ["Konsep Wilayah dan Tata Ruang", "Interaksi Desa-Kota", "Negara Maju dan Berkembang"], "Ekonomi": ["Akuntansi Perusahaan Jasa", "Jurnal Umum", "Laporan Keuangan"], "Sosiologi": ["Perubahan Sosial", "Globalisasi", "Ketimpangan Sosial", "Pemberdayaan Komunitas"] } },
                "Universitas": { "S1 (Sarjana)": { "Teknik Informatika": ["Kalkulus I", "Dasar Pemrograman", "Logika Informatika", "Sistem Digital", "Struktur Data & Algoritma"], "Ekonomi & Bisnis": ["Pengantar Ekonomi Mikro", "Pengantar Ekonomi Makro", "Matematika Ekonomi", "Akuntansi Dasar", "Pengantar Manajemen"], "Ilmu Hukum": ["Pengantar Ilmu Hukum", "Pengantar Hukum Indonesia", "Ilmu Negara", "Hukum Perdata", "Hukum Pidana"], "Ilmu Komunikasi": ["Pengantar Ilmu Komunikasi", "Teori Komunikasi", "Komunikasi Massa", "Psikologi Komunikasi", "Public Speaking"], "Psikologi": ["Psikologi Umum", "Biopsikologi", "Statistika Psikologi", "Psikologi Perkembangan", "Psikologi Sosial"] }, "S2 (Magister)": { "Manajemen": ["Manajemen Strategis", "Manajemen Pemasaran Lanjutan", "Manajemen Keuangan Korporat", "Metodologi Penelitian Bisnis"], "Teknik Informatika": ["Kecerdasan Buatan Lanjutan", "Rekayasa Perangkat Lunak Skala Besar", "Keamanan Siber", "Analisis Big Data"], "Hukum": ["Filsafat Hukum", "Teori Hukum", "Politik Hukum", "Metodologi Penelitian Hukum"] }, "S3 (Doktor)": { "Studi Pembangunan": ["Teori Pembangunan Lanjutan", "Metodologi Penelitian Kualitatif Lanjutan", "Metodologi Penelitian Kuantitatif Lanjutan", "Disertasi"], "Ilmu Ekonomi": ["Teori Mikroekonomi Lanjutan", "Teori Makroekonomi Lanjutan", "Ekonometrika", "Disertasi"], "Ilmu Komputer": ["Topik Khusus dalam AI", "Jaringan Komputer Lanjutan", "Penelitian Mandiri", "Disertasi"] } }
            };
            
            // --- Premium UI Template Functions ---
            
            function createPremiumFileUploaderHTML(prefix, label, helpText = '') {
                return `
                        <div class="mb-6">
                            <label for="${prefix}-gambar" class="block text-sm font-semibold text-slate-700 mb-2">${label}</label>
                            ${helpText ? `<p class="text-xs text-slate-500 mb-3">${helpText}</p>` : ''}
                            <div class="premium-file-upload">
                                <input type="file" id="${prefix}-gambar" accept="image/*" class="hidden"/>
                                <div class="cursor-pointer" onclick="document.getElementById('${prefix}-gambar').click()">
                                    <i class="fas fa-cloud-upload-alt text-4xl text-primary-500 mb-4"></i>
                                    <p class="font-semibold text-slate-700">Klik untuk upload gambar</p>
                                    <p class="text-sm text-slate-500">atau drag & drop file</p>
                                </div>
                            </div>
                            <div id="${prefix}-preview" class="mt-6 hidden relative inline-block">
                                <button id="${prefix}-remove-img" title="Hapus gambar" class="absolute top-0 right-0 -mt-3 -mr-3 bg-red-500 hover:bg-red-600 text-white rounded-full h-8 w-8 flex items-center justify-center text-lg font-bold z-10 transition-all shadow-lg">&times;</button>
                                <img id="${prefix}-preview-img" class="max-h-64 rounded-2xl border-4 border-white shadow-xl"/>
                            </div>
                        </div>
                `;
            }

            function createPremiumTopicSelectorHTML(prefix, title, optionsHTML = '', buttonText = 'Generate', buttonIcon = 'fa-cogs') {
                const isAnalysis = prefix === 'rpp-analisis';
                const buttonClass = isAnalysis ? 
                    'premium-button bg-gradient-to-r from-slate-600 to-slate-800 hover:from-slate-700 hover:to-slate-900' : 
                    'premium-button';

                return `
                        <div class="max-w-6xl mx-auto">
                        <h1 class="text-2xl sm:text-3xl font-black mb-8 text-slate-900 text-center">${title}</h1>
                        <div class="premium-card p-4 sm:p-6 md:p-10">
                            <div class="mb-8">
                                <h2 class="text-lg md:text-xl font-bold text-slate-800 mb-4 flex items-center">
                                    <i class="fas fa-lightbulb text-primary-500 mr-3"></i>
                                    Pilih Salah Satu Cara untuk Menentukan Topik
                                    </h2>
                                    <div class="glass-effect rounded-2xl p-4 sm:p-6 mb-6">
                                        <label class="text-base md:text-lg font-semibold text-slate-800 mb-6 block flex items-center">
                                            <i class="fas fa-graduation-cap text-primary-500 mr-3"></i>
                                            Opsi 1: Pilih dari Kurikulum
                                        </label>
                                        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4">
                                            <select id="${prefix}-jenjang" class="premium-select w-full">
                                                <option value="">Pilih Jenjang...</option>
                                            </select>
                                            <select id="${prefix}-kelas" class="premium-select w-full" disabled>
                                                <option value="">Pilih Kelas...</option>
                                            </select>
                                            <select id="${prefix}-mapel" class="premium-select w-full" disabled>
                                                <option value="">Pilih Mapel...</option>
                                            </select>
                                            <select id="${prefix}-bab" class="premium-select w-full" disabled>
                                                <option value="">Pilih Bab...</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="flex items-center my-6">
                                        <hr class="flex-grow border-t-2 border-slate-300">
                                        <span class="mx-4 text-slate-600 font-bold text-sm sm:text-base px-3 py-1 bg-slate-100 rounded-full">ATAU</span>
                                        <hr class="flex-grow border-t-2 border-slate-300">
                                    </div>
                                    <div>
                                        <label for="${prefix}-topik" class="text-base md:text-lg font-semibold text-slate-800 mb-4 block flex items-center">
                                            <i class="fas fa-edit text-primary-500 mr-3"></i>
                                            Opsi 2: Tulis Topik Sendiri
                                        </label>
                                        <textarea id="${prefix}-topik" rows="3" class="premium-textarea w-full text-sm sm:text-base" placeholder="Ketik topik spesifik Anda di sini..."></textarea>
                                    </div>
                                    ${optionsHTML}
                                </div>
                                <button id="btn-generate-${prefix}" class="${buttonClass} w-full text-base py-3 sm:text-lg">
                                    <i class="fas ${buttonIcon} mr-3"></i> ${buttonText}
                                </button>
                                <div id="${prefix}-loader" class="hidden mt-8 flex flex-col items-center">
                                    <div class="premium-loader"></div>
                                    <p class="mt-4 text-slate-600 font-medium">AI sedang bekerja untuk Anda...</p>
                                </div>
                                <div id="${prefix}-hasil" class="mt-12 hidden premium-ai-output"></div>
                            </div>
                        </div>
                `;
            }

            // --- Build Premium UI ---
            function buildPremiumUI() {
                // Generator Materi
                const materiOptions = `
                        <div class="mt-8 pt-8 border-t-2 border-slate-200">
                            <label for="materi-diferensiasi" class="flex items-center cursor-pointer p-4 glass-effect rounded-xl hover:bg-primary-50 transition-all">
                                <input type="checkbox" id="materi-diferensiasi" class="h-5 w-5 text-primary-600 border-slate-300 rounded focus:ring-primary-500 mr-4">
                                <div>
                                    <span class="text-base sm:text-lg font-semibold text-slate-700">Aktifkan Diferensiasi Materi</span>
                                    <p class="text-sm text-slate-500">Buat 3 versi: disederhanakan, standar, dan pengayaan</p>
                                </div>
                            </label>
                        </div>`;
                document.getElementById('generator-materi').innerHTML = createPremiumTopicSelectorHTML('materi', 'Generator Materi Ajar Premium', materiOptions, 'Buat Materi Berkualitas Tinggi', 'fa-magic');

                // Pembuat Soal
                const soalOptions = `
                        <div class="mt-8 pt-8 border-t-2 border-slate-200">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                    <label for="soal-tipe" class="block text-base sm:text-lg font-semibold text-slate-700 mb-3">Tipe Soal</label>
                                    <select id="soal-tipe" class="premium-select w-full text-sm sm:text-base">
                                        <option>Pilihan Ganda</option>
                                        <option>Esai Singkat</option>
                                        <option>Benar/Salah</option>
                                        <option>Studi Kasus</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="soal-jumlah" class="block text-base sm:text-lg font-semibold text-slate-700 mb-3">Jumlah Soal</label>
                                    <input type="number" id="soal-jumlah" class="premium-input w-full text-sm sm:text-base" value="5" min="1" max="20">
                                </div>
                            </div>
                            <div class="mt-6">
                                <label for="soal-pembahasan" class="flex items-center cursor-pointer p-4 glass-effect rounded-xl hover:bg-primary-50 transition-all">
                                    <input type="checkbox" id="soal-pembahasan" class="h-5 w-5 text-primary-600 border-slate-300 rounded focus:ring-primary-500 mr-4" checked>
                                    <div>
                                        <span class="text-base sm:text-lg font-semibold text-slate-700">Sertakan Pembahasan Jawaban Rinci</span>
                                        <p class="text-sm text-slate-500">Dapatkan penjelasan lengkap untuk setiap jawaban</p>
                                    </div>
                                </label>
                            </div>
                        </div>`;
                document.getElementById('pembuat-soal').innerHTML = createPremiumTopicSelectorHTML('soal', 'Pembuat Soal Otomatis Premium', soalOptions, 'Buat Soal Profesional', 'fa-lightbulb');
                
                // Pustaka Aktivitas (Premium Card Layout)
                const a_activities = [
                    { type: 'Debat', title: 'Debat Akademik', icon: 'fa-comments', desc: 'Latih kemampuan berargumen dan berpikir kritis siswa dengan struktur debat profesional.' },
                    { type: 'Studi Kasus', title: 'Analisis Studi Kasus', icon: 'fa-file-signature', desc: 'Pelajari skenario dunia nyata dengan pendekatan analitis mendalam.' },
                    { type: 'Role-Playing', title: 'Simulasi Peran', icon: 'fa-theater-masks', desc: 'Simulasikan situasi kompleks untuk pemahaman holistik dan empati.' },
                    { type: 'Jigsaw', title: 'Pembelajaran Jigsaw', icon: 'fa-puzzle-piece', desc: 'Dorong kolaborasi tim dan akuntabilitas individual yang efektif.' },
                    { type: 'Galeri Walk', title: 'Pameran Karya', icon: 'fa-images', desc: 'Presentasi dan evaluasi hasil karya dengan apresiasi interaktif.' }
                ];
                let premiumActivityCardsHTML = a_activities.map((activity, index) => `
                        <div class="premium-feature-card p-4 sm:p-6 cursor-pointer group activity-choice-card" data-activity-type="${activity.type}" data-activity-title="${activity.title}" style="animation-delay: ${0.2 + index * 0.1}s">
                            <div class="icon-container w-14 h-14 sm:w-16 sm:h-16">
                                <i class="fas ${activity.icon} text-xl sm:text-2xl text-white"></i>
                            </div>
                            <h3 class="text-lg sm:text-xl font-bold mb-4 text-slate-800 group-hover:text-primary-600 transition-colors">${activity.title}</h3>
                            <p class="text-sm sm:text-base text-slate-600 leading-relaxed">${activity.desc}</p>
                            <div class="mt-6 flex items-center text-primary-600 font-semibold">
                                <span>Pilih Aktivitas Ini</span>
                                <i class="fas fa-arrow-right ml-2 group-hover:translate-x-2 transition-transform"></i>
                            </div>
                        </div>
                `).join('');

                document.getElementById('pustaka-aktivitas').innerHTML = `
                        <div class="max-w-7xl mx-auto">
                            <div class="text-center mb-12">
                                <h1 class="text-2xl sm:text-3xl font-black mb-6 text-slate-900">Pustaka Aktivitas Interaktif Premium</h1>
                                <p class="text-base sm:text-lg text-slate-600 mb-8 max-w-4xl mx-auto">Pilih tipe aktivitas pembelajaran yang inovatif untuk menciptakan pengalaman belajar yang memorable.</p>
                            </div>
                            <div id="aktivitas-card-container" class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6 md:gap-8">
                                ${premiumActivityCardsHTML}
                            </div>
                            <div id="aktivitas-form-container" class="hidden">
                                <!-- Form akan diinjeksi di sini -->
                            </div>
                        </div>
                `;

                // Other sections with premium styling
                document.getElementById('pembuat-kuis').innerHTML = createPremiumTopicSelectorHTML('kuis', 'Pembuat Kuis Cepat Premium', '', 'Buat Kuis Interaktif', 'fa-graduation-cap');
                
                // RPP Section dengan tab premium
                document.getElementById('perencana-rpp').innerHTML = `
                        <div class="max-w-7xl mx-auto">
                            <h1 class="text-2xl sm:text-3xl font-black mb-8 text-slate-900 text-center">Perencana & Analisis RPP Premium</h1>
                            <div id="perencana-rpp-tabs-container" class="premium-card p-4 sm:p-6 md:p-8">
                                <div class="border-b-2 border-slate-200 mb-8">
                                    <nav class="flex space-x-2 sm:space-x-8" aria-label="Tabs">
                                        <button class="premium-tab-button active" data-target="tab-buat-rpp">
                                            <i class="fas fa-file-plus mr-2"></i>Buat Draf RPP Baru
                                        </button>
                                        <button class="premium-tab-button" data-target="tab-analisis-rpp">
                                            <i class="fas fa-search-plus mr-2"></i>Analisis RPP Saya
                                        </button>
                                    </nav>
                                </div>
                                <div id="tab-buat-rpp" class="tab-content active">
                                    ${createPremiumTopicSelectorHTML('rpp', '', `
                                    <div class="mt-8 pt-8 border-t-2 border-slate-200 grid grid-cols-1 md:grid-cols-2 gap-6">
                                        <div>
                                            <label for="rpp-durasi" class="block text-base sm:text-lg font-semibold text-slate-700 mb-3">Durasi (menit)</label>
                                            <input type="number" id="rpp-durasi" class="premium-input w-full text-sm sm:text-base" value="90">
                                        </div>
                                        <div>
                                            <label for="rpp-tujuan" class="block text-base sm:text-lg font-semibold text-slate-700 mb-3">Tujuan Pembelajaran Utama</label>
                                            <input type="text" id="rpp-tujuan" class="premium-input w-full text-sm sm:text-base" placeholder="Contoh: Siswa mampu menjelaskan kronologi...">
                                        </div>
                                    </div>`, 'Buat Draf RPP Premium', 'fa-file-alt')}
                                </div>
                                <div id="tab-analisis-rpp" class="tab-content">
                                    <div class="premium-card p-4 sm:p-6">
                                        <h2 class="text-xl sm:text-2xl font-bold mb-6 text-slate-900 flex items-center">
                                            <i class="fas fa-search-plus text-primary-500 mr-4"></i>
                                            Analisis & Refleksi RPP Professional
                                        </h2>
                                        <p class="text-sm sm:text-base text-slate-600 mb-8 leading-relaxed">Tempelkan draf RPP yang sudah Anda buat untuk mendapatkan umpan balik konstruktif dan saran perbaikan berdasarkan prinsip pedagogi terkini.</p>
                                        <label for="analisis-rpp-teks" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Tempel Draf RPP Anda di Sini</label>
                                        <textarea id="analisis-rpp-teks" rows="15" class="premium-textarea w-full text-sm sm:text-base" placeholder="Salin dan tempel seluruh isi RPP Anda di sini untuk analisis mendalam..."></textarea>
                                        <button id="btn-generate-analisis-rpp" class="premium-button bg-gradient-to-r from-slate-600 to-slate-800 hover:from-slate-700 hover:to-slate-900 mt-8 w-full text-base py-3 sm:text-lg">
                                            <i class="fas fa-search-plus mr-3"></i> Dapatkan Umpan Balik Pedagogis Expert
                                        </button>
                                        <div id="analisis-rpp-loader" class="hidden mt-8 flex flex-col items-center">
                                            <div class="premium-loader"></div>
                                            <p class="mt-4 text-slate-600 font-medium">AI sedang menganalisis RPP Anda secara mendalam...</p>
                                        </div>
                                        <div id="analisis-rpp-hasil" class="mt-12 hidden premium-ai-output"></div>
                                    </div>
                                </div>
                            </div>
                        </div>`;

                // Premium sections without topic selector
                document.getElementById('generator-glosarium').innerHTML = `
                        <div class="max-w-6xl mx-auto">
                            <h1 class="text-2xl sm:text-3xl font-black mb-8 text-slate-900 text-center">Generator Glosarium & Konteks Kata Premium</h1>
                            <div class="premium-card p-4 sm:p-6 md:p-12">
                                <div class="text-center mb-8">
                                    <i class="fas fa-spell-check text-5xl text-primary-500 mb-6"></i>
                                    <p class="text-base sm:text-lg text-slate-600 leading-relaxed">Ekstrak dan analisis istilah kunci dari materi bacaan dengan AI yang canggih dan konteks yang mendalam.</p>
                                </div>
                                <label for="glosarium-teks" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Tempel Teks Materi Anda</label>
                                <textarea id="glosarium-teks" rows="12" class="premium-textarea w-full text-sm sm:text-base" placeholder="Tempelkan artikel, bab buku, jurnal, atau materi bacaan di sini untuk dianalisis..."></textarea>
                                <button id="btn-generate-glosarium" class="premium-button mt-8 w-full text-base py-3 sm:text-lg">
                                    <i class="fas fa-magic mr-3"></i> Buat Glosarium Profesional
                                </button>
                                <div id="glosarium-loader" class="hidden mt-8 flex flex-col items-center">
                                    <div class="premium-loader"></div>
                                    <p class="mt-4 text-slate-600 font-medium">AI sedang mengidentifikasi istilah kunci...</p>
                                </div>
                                <div id="glosarium-hasil" class="mt-12 hidden premium-ai-output"></div>
                            </div>
                        </div>`;

                document.getElementById('konteks-visual').innerHTML = `
                        <div class="max-w-6xl mx-auto">
                            <h1 class="text-2xl sm:text-3xl font-black mb-8 text-slate-900 text-center">Konteks Visual Cerdas Premium</h1>
                            <div class="premium-card p-4 sm:p-6 md:p-12">
                                <div class="text-center mb-8">
                                    <i class="fas fa-image text-5xl text-primary-500 mb-6"></i>
                                    <p class="text-base sm:text-lg text-slate-600 leading-relaxed">Analisis mendalam gambar untuk menciptakan bahan diskusi dan pertanyaan HOTS yang bermakna.</p>
                                </div>
                                ${createPremiumFileUploaderHTML('konteks', 'Unggah Gambar untuk Analisis', 'Upload foto bersejarah, diagram, karya seni, grafik, atau visual pembelajaran lainnya.')}
                                <button id="btn-generate-konteks" class="premium-button w-full text-base py-3 sm:text-lg">
                                    <i class="fas fa-search-plus mr-3"></i> Analisis Gambar dengan AI
                                </button>
                                <div id="konteks-loader" class="hidden mt-8 flex flex-col items-center">
                                    <div class="premium-loader"></div>
                                    <p class="mt-4 text-slate-600 font-medium">AI sedang menganalisis konteks visual...</p>
                                </div>
                                <div id="konteks-hasil" class="mt-12 hidden premium-ai-output"></div>
                            </div>
                        </div>`;
                
                document.getElementById('penjawab-soal').innerHTML = `
                        <div class="max-w-6xl mx-auto">
                            <h1 class="text-2xl sm:text-3xl font-black mb-8 text-slate-900 text-center">Penjawab Soal Cerdas Premium</h1>
                            <div class="premium-card p-4 sm:p-6 md:p-12">
                                <div class="text-center mb-8">
                                    <i class="fas fa-calculator text-5xl text-primary-500 mb-6"></i>
                                    <p class="text-base sm:text-lg text-slate-600 leading-relaxed mb-8">Dapatkan solusi lengkap dan pembahasan step-by-step untuk soal dalam bentuk teks atau gambar dengan akurasi tinggi.</p>
                                </div>
                                <div class="mb-8">
                                    <label for="penjawab-soal-teks" class="text-base sm:text-lg font-semibold text-slate-800 mb-4 block flex items-center">
                                        <i class="fas fa-keyboard text-primary-500 mr-3"></i>
                                        Masukkan Soal (Teks)
                                    </label>
                                    <textarea id="penjawab-soal-teks" rows="5" class="premium-textarea w-full text-sm sm:text-base" placeholder="Ketik atau tempel soal di sini..."></textarea>
                                </div>
                                <div class="flex items-center my-6">
                                    <hr class="flex-grow border-t-2 border-slate-300">
                                    <span class="mx-4 text-slate-600 font-bold text-sm sm:text-base px-3 py-1 bg-slate-100 rounded-full">ATAU</span>
                                    <hr class="flex-grow border-t-2 border-slate-300">
                                </div>
                                ${createPremiumFileUploaderHTML('penjawab-soal', 'Unggah Gambar Soal', 'Upload foto soal dari buku, lembar ujian, atau sumber lainnya.')}
                                <button id="btn-generate-penjawab-soal" class="premium-button w-full text-base py-3 sm:text-lg">
                                    <i class="fas fa-calculator mr-3"></i> Jawab & Bahas Soal Lengkap
                                </button>
                                <div id="penjawab-soal-loader" class="hidden mt-8 flex flex-col items-center">
                                    <div class="premium-loader"></div>
                                    <p class="mt-4 text-slate-600 font-medium">AI sedang mengerjakan dan membahas soal...</p>
                                </div>
                                <div id="penjawab-soal-hasil" class="mt-12 hidden premium-ai-output"></div>
                            </div>
                        </div>`;

                document.getElementById('perancang-proyek').innerHTML = `
                        <div class="max-w-6xl mx-auto">
                            <h1 class="text-2xl sm:text-3xl font-black mb-8 text-slate-900 text-center">Perancang Proyek Kolaboratif (PBL) Premium</h1>
                            <div class="premium-card p-4 sm:p-6 md:p-12">
                                <div class="text-center mb-8">
                                    <i class="fas fa-sitemap text-5xl text-primary-500 mb-6"></i>
                                    <p class="text-base sm:text-lg text-slate-600 leading-relaxed mb-8">Otomatisasi perencanaan Project-Based Learning (PBL) yang komprehensif. Input tema dan durasi, dapatkan kerangka kerja profesional.</p>
                                </div>
                                <div class="mb-8">
                                    <label for="proyek-tema" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Tema / Masalah Utama Proyek</label>
                                    <input type="text" id="proyek-tema" class="premium-input w-full text-sm sm:text-base" placeholder="Contoh: Mengatasi Masalah Sampah Plastik di Lingkungan Sekolah">
                                </div>
                                <div class="mb-8">
                                    <label for="proyek-durasi" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Estimasi Durasi Proyek</label>
                                    <input type="text" id="proyek-durasi" class="premium-input w-full text-sm sm:text-base" placeholder="Contoh: 2-3 minggu">
                                </div>
                                <button id="btn-generate-proyek" class="premium-button w-full text-base py-3 sm:text-lg">
                                    <i class="fas fa-sitemap mr-3"></i> Rancang Kerangka Proyek Professional
                                </button>
                                <div id="proyek-loader" class="hidden mt-8 flex flex-col items-center">
                                    <div class="premium-loader"></div>
                                    <p class="mt-4 text-slate-600 font-medium">AI sedang merancang struktur proyek pembelajaran...</p>
                                </div>
                                <div id="proyek-hasil" class="mt-12 hidden premium-ai-output"></div>
                            </div>
                        </div>`;

                document.getElementById('asisten-pertanyaan').innerHTML = `
                        <div class="max-w-6xl mx-auto">
                            <h1 class="text-2xl sm:text-3xl font-black mb-8 text-slate-900 text-center">Asisten Pertanyaan Siswa Premium</h1>
                            <div class="premium-card p-4 sm:p-6 md:p-12">
                                <div class="text-center mb-8">
                                    <i class="fas fa-question-circle text-5xl text-primary-500 mb-6"></i>
                                    <p class="text-base sm:text-lg text-slate-600 leading-relaxed mb-8">Dapatkan strategi kreatif dan pendekatan pedagogis untuk menjawab pertanyaan challenging dari siswa.</p>
                                </div>
                                <label for="pertanyaan-siswa" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Masukkan Pertanyaan Sulit dari Siswa</label>
                                <textarea id="pertanyaan-siswa" rows="5" class="premium-textarea w-full text-sm sm:text-base" placeholder="Contoh: Bu, kenapa kita tidak merasakan bumi berputar? Kan kecepatannya sangat cepat..."></textarea>
                                <button id="btn-generate-jawaban" class="premium-button mt-8 w-full text-base py-3 sm:text-lg">
                                    <i class="fas fa-hands-helping mr-3"></i> Dapatkan Strategi Jawaban Kreatif
                                </button>
                                <div id="jawaban-loader" class="hidden mt-8 flex flex-col items-center">
                                    <div class="premium-loader"></div>
                                    <p class="mt-4 text-slate-600 font-medium">AI sedang menyiapkan pendekatan terbaik...</p>
                                </div>
                                <div id="jawaban-hasil" class="mt-12 hidden premium-ai-output"></div>
                            </div>
                        </div>`;
                
                document.getElementById('penilaian-otomatis').innerHTML = `
                        <div class="max-w-7xl mx-auto">
                            <h1 class="text-2xl sm:text-3xl font-black mb-8 text-slate-900 text-center">Pengecekan & Penilaian AI Premium</h1>
                            <div id="penilaian-tabs-container" class="premium-card p-4 sm:p-6 md:p-8">
                                <div class="border-b-2 border-slate-200 mb-8">
                                    <nav class="flex flex-wrap gap-2 sm:gap-4" aria-label="Tabs">
                                        <button class="premium-tab-button active text-sm sm:text-base px-2 py-2 sm:px-3 sm:py-2" data-target="tab-penilaian-terpadu">
                                            <i class="fas fa-magic mr-2"></i>Penilaian Terpadu
                                        </button>
                                        <button class="premium-tab-button text-sm sm:text-base px-2 py-2 sm:px-3 sm:py-2" data-target="tab-penilaian-pg">
                                            <i class="fas fa-check-circle mr-2"></i>Mode PG
                                        </button>
                                        <button class="premium-tab-button text-sm sm:text-base px-2 py-2 sm:px-3 sm:py-2" data-target="tab-penilaian-esai">
                                            <i class="fas fa-pen-fancy mr-2"></i>Mode Esai
                                        </button>
                                    </nav>
                                </div>

                                <!-- Tab: Penilaian Terpadu -->
                                <div id="tab-penilaian-terpadu" class="tab-content active">
                                    <div class="text-center mb-8">
                                        <h2 class="text-xl sm:text-2xl font-bold mb-4 text-slate-900">Penilaian Lembar Jawaban Terpadu</h2>
                                        <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Mode paling fleksibel. Upload foto lembar jawaban siswa (campuran PG dan esai) untuk penilaian otomatis.</p>
                                    </div>
                                    
                                    ${createPremiumFileUploaderHTML('penilaian-terpadu', 'Unggah Lembar Jawaban Siswa', 'Upload foto lembar jawaban yang sudah diisi siswa')}
                                    <div class="mt-8 pt-8 border-t-2 border-slate-200">
                                        <label class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Kunci Jawaban (Opsional)</label>
                                        <p class="text-sm text-slate-500 mb-4">Berikan kunci jawaban untuk akurasi maksimal. Jika kosong, AI akan menentukan jawaban benar.</p>
                                        <textarea id="penilaian-terpadu-kunci-teks" rows="4" class="premium-textarea w-full mb-4" placeholder="Contoh: 1. A, 2. C, 3. B ... atau poin-poin esai"></textarea>
                                        ${createPremiumFileUploaderHTML('penilaian-terpadu-kunci', 'Upload Kunci Jawaban (Gambar)', 'Opsional: upload gambar kunci jawaban')}
                                    </div>
                                    <div class="mt-6">
                                        <label for="penilaian-terpadu-skala" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Skala Nilai</label>
                                        <select id="penilaian-terpadu-skala" class="premium-select w-full md:w-1/2 lg:w-1/3">
                                            <option>1 - 100</option><option>1 - 10</option><option>A - E</option>
                                        </select>
                                    </div>
                                    <button id="btn-generate-penilaian-terpadu" class="premium-button mt-8 w-full text-base py-3 sm:text-lg">
                                        <i class="fas fa-magic mr-3"></i> Periksa Lembar Jawaban dengan AI
                                    </button>
                                    <div id="penilaian-terpadu-loader" class="hidden mt-8 flex flex-col items-center">
                                        <div class="premium-loader"></div>
                                        <p class="mt-4 text-slate-600 font-medium">AI sedang menganalisis dan menilai...</p>
                                    </div>
                                    <div id="penilaian-terpadu-hasil" class="mt-12 hidden premium-ai-output"></div>
                                </div>

                                <!-- Tab Content for PG -->
                                <div id="tab-penilaian-pg" class="tab-content">
                                    <div class="text-center mb-8">
                                        <h2 class="text-xl sm:text-2xl font-bold mb-4 text-slate-900">Mode Pilihan Ganda Spesifik</h2>
                                        <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Fokus khusus untuk penilaian lembar jawaban pilihan ganda dengan tingkat akurasi maksimal.</p>
                                    </div>
                                    <div id="penilaian-pg-content-wrapper"></div>
                                </div>
                                
                                <!-- Tab Content for Esai -->
                                <div id="tab-penilaian-esai" class="tab-content">
                                    <div class="text-center mb-8">
                                        <h2 class="text-xl sm:text-2xl font-bold mb-4 text-slate-900">Mode Esai Spesifik</h2>
                                        <p class="text-sm sm:text-base text-slate-600 leading-relaxed">Penilaian esai yang mendalam dengan analisis kualitas jawaban yang komprehensif.</p>
                                    </div>
                                    <div id="penilaian-esai-content-wrapper"></div>
                                </div>
                            </div>
                        </div>`;

                document.getElementById('komunikasi-ortu').innerHTML = `
                        <div class="max-w-6xl mx-auto">
                            <h1 class="text-2xl sm:text-3xl font-black mb-8 text-slate-900 text-center">Generator Komunikasi Orang Tua Premium</h1>
                            <div class="premium-card p-4 sm:p-6 md:p-12">
                                <div class="text-center mb-8">
                                    <i class="fas fa-envelope text-5xl text-primary-500 mb-6"></i>
                                    <p class="text-base sm:text-lg text-slate-600 leading-relaxed mb-8">Buat pesan profesional dan efektif untuk komunikasi dengan orang tua/wali siswa dengan tone yang tepat.</p>
                                </div>
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                    <div>
                                        <label for="komunikasi-nama" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Nama Siswa</label>
                                        <input type="text" id="komunikasi-nama" class="premium-input w-full text-sm sm:text-base" placeholder="Contoh: Budi Santoso">
                                    </div>
                                    <div>
                                        <label for="komunikasi-tujuan" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Tujuan Komunikasi</label>
                                        <select id="komunikasi-tujuan" class="premium-select w-full text-sm sm:text-base">
                                            <option>Memberi apresiasi atas pencapaian</option>
                                            <option>Menyampaikan kendala belajar</option>
                                            <option>Mendiskusikan perkembangan perilaku</option>
                                            <option>Informasi kegiatan sekolah</option>
                                            <option>Undangan pertemuan orang tua</option>
                                            <option>Laporan perkembangan akademik</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="mb-8">
                                    <label for="komunikasi-poin" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Poin-Poin Kunci</label>
                                    <textarea id="komunikasi-poin" rows="5" class="premium-textarea w-full text-sm sm:text-base" placeholder="- Aktif bertanya di kelas&#10;- Menunjukkan peningkatan dalam matematika&#10;- Perlu bimbingan tambahan di rumah&#10;- Antusias mengikuti ekstrakurikuler"></textarea>
                                </div>
                                <button id="btn-generate-komunikasi" class="premium-button w-full text-base py-3 sm:text-lg">
                                    <i class="fas fa-paper-plane mr-3"></i> Buat Draf Pesan Professional
                                </button>
                                <div id="komunikasi-loader" class="hidden mt-8 flex flex-col items-center">
                                    <div class="premium-loader"></div>
                                    <p class="mt-4 text-slate-600 font-medium">AI sedang menyusun pesan yang tepat...</p>
                                </div>
                                <div id="komunikasi-hasil" class="mt-12 hidden premium-ai-output"></div>
                            </div>
                        </div>`;
                
                // Inject PG and Esai specific content
                const pgContentWrapper = document.getElementById('penilaian-pg-content-wrapper');
                if(pgContentWrapper) {
                    pgContentWrapper.innerHTML = `
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                    <div>
                                        <label for="penilaian-otomatis-nama" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Nama Siswa (Opsional)</label>
                                        <input type="text" id="penilaian-otomatis-nama" class="premium-input w-full text-sm sm:text-base" placeholder="AI akan deteksi dari gambar">
                                    </div>
                                    <div>
                                        <label for="penilaian-otomatis-kelas" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Kelas (Opsional)</label>
                                        <input type="text" id="penilaian-otomatis-kelas" class="premium-input w-full text-sm sm:text-base" placeholder="AI akan deteksi dari gambar">
                                    </div>
                                </div>
                                <div class="mb-8">
                                    <label for="penilaian-otomatis-skala" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Skala Nilai</label>
                                    <select id="penilaian-otomatis-skala" class="premium-select w-full md:w-1/2 lg:w-1/3">
                                        <option>1 - 100</option><option>1 - 10</option><option>A - E</option>
                                    </select>
                                </div>
                                <div class="mb-8">
                                    ${createPremiumFileUploaderHTML('penilaian-otomatis', 'Unggah Lembar Jawaban Siswa', 'Upload lembar jawaban pilihan ganda yang sudah diisi')}
                                </div>
                                <div class="pt-8 border-t-2 border-slate-200">
                                    <label class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Kunci Jawaban (Opsional)</label>
                                    <p class="text-sm text-slate-500 mb-4">Untuk akurasi maksimal, berikan kunci jawaban. Jika kosong, AI akan menentukan sendiri.</p>
                                    <textarea id="penilaian-otomatis-kunci-teks" rows="4" class="premium-textarea w-full mb-4" placeholder="Contoh: 1. A, 2. C, 3. B, 4. D, 5. A..."></textarea>
                                    ${createPremiumFileUploaderHTML('penilaian-otomatis-kunci', 'Upload Kunci Jawaban (Gambar)', 'Opsional: upload gambar kunci jawaban')}
                                </div>
                                <button id="btn-generate-penilaian-otomatis" class="premium-button mt-8 w-full text-base py-3 sm:text-lg">
                                    <i class="fas fa-magic mr-3"></i> Periksa Pilihan Ganda Otomatis
                                </button>
                                <div id="penilaian-otomatis-loader" class="hidden mt-8 flex flex-col items-center">
                                    <div class="premium-loader"></div>
                                    <p class="mt-4 text-slate-600 font-medium">AI sedang memeriksa jawaban pilihan ganda...</p>
                                </div>
                                <div id="penilaian-otomatis-hasil" class="mt-12 hidden premium-ai-output"></div>
                    `;
                }

                const esaiContentWrapper = document.getElementById('penilaian-esai-content-wrapper');
                if(esaiContentWrapper) {
                    esaiContentWrapper.innerHTML = `
                                <div id="penilaian-esai-nested-tabs-container">
                                    <nav class="mb-8 border-b border-slate-200 flex space-x-4 sm:space-x-6" aria-label="Nested Tabs">
                                        <button class="premium-tab-button active text-sm sm:text-base" data-target="tab-esai-otomatis">
                                            <i class="fas fa-robot mr-2"></i>Mode Otomatis
                                        </button>
                                        <button class="premium-tab-button text-sm sm:text-base" data-target="tab-esai-manual">
                                            <i class="fas fa-user-edit mr-2"></i>Mode dengan Kunci
                                        </button>
                                    </nav>

                                    <!-- Nested Tab: Esai Otomatis -->
                                    <div id="tab-esai-otomatis" class="tab-content-nested active">
                                        <div>
                                            <h3 class="text-xl sm:text-2xl font-bold mb-4 text-slate-900 flex items-center">
                                                <i class="fas fa-robot text-primary-500 mr-3"></i>
                                                Mode Otomatis Penuh (Esai)
                                            </h3>
                                            <p class="text-sm sm:text-base text-slate-600 mb-8 leading-relaxed">Upload soal dan jawaban esai siswa. AI akan menganalisis, mendeteksi identitas, dan memberikan penilaian komprehensif.</p>
                                            <div class="mb-8">
                                                <label class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Soal Esai</label>
                                                <textarea id="penilaian-esai-otomatis-soal" rows="4" class="premium-textarea w-full text-sm sm:text-base" placeholder="Ketik atau tempel soal esai di sini..."></textarea>
                                            </div>
                                            <div class="pt-8 border-t-2 border-slate-200 mb-8">
                                                <label class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Jawaban Esai Siswa</label>
                                                <textarea id="penilaian-esai-otomatis-jawaban-teks" rows="6" class="premium-textarea w-full text-sm sm:text-base mb-4" placeholder="Ketik atau tempel jawaban siswa di sini..."></textarea>
                                                ${createPremiumFileUploaderHTML('penilaian-esai-otomatis-jawaban', 'Upload Jawaban Esai (Gambar)', 'Alternatif: upload foto jawaban esai siswa')}
                                            </div>
                                            <div class="mb-8">
                                                <label for="penilaian-esai-otomatis-skala" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Skala Nilai</label>
                                                <select id="penilaian-esai-otomatis-skala" class="premium-select w-full md:w-1/2 lg:w-1/3">
                                                    <option>1 - 100</option><option>1 - 10</option><option>A - E</option>
                                                </select>
                                            </div>
                                            <button id="btn-generate-penilaian-esai-otomatis" class="premium-button w-full text-base py-3 sm:text-lg">
                                                <i class="fas fa-magic mr-3"></i> Nilai Esai Otomatis dengan AI
                                            </button>
                                            <div id="penilaian-esai-otomatis-loader" class="hidden mt-8 flex flex-col items-center">
                                                <div class="premium-loader"></div>
                                                <p class="mt-4 text-slate-600 font-medium">AI sedang menganalisis dan menilai esai...</p>
                                            </div>
                                            <div id="penilaian-esai-otomatis-hasil" class="mt-12 hidden premium-ai-output"></div>
                                        </div>
                                    </div>
                                    
                                    <!-- Nested Tab: Esai Manual -->
                                    <div id="tab-esai-manual" class="tab-content-nested">
                                        <div>
                                            <h3 class="text-xl sm:text-2xl font-bold mb-4 text-slate-900 flex items-center">
                                                <i class="fas fa-user-edit text-primary-500 mr-3"></i>
                                                Mode dengan Kunci Jawaban (Esai)
                                            </h3>
                                            <p class="text-sm sm:text-base text-slate-600 mb-8 leading-relaxed">Untuk esai kompleks dengan pedoman penilaian spesifik yang Anda tentukan sendiri.</p>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                                <div>
                                                    <label for="penilaian-manual-nama" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Nama Siswa</label>
                                                    <input type="text" id="penilaian-manual-nama" class="premium-input w-full text-sm sm:text-base" placeholder="Contoh: Ani Sari">
                                                </div>
                                                <div>
                                                    <label for="penilaian-manual-kelas" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Kelas</label>
                                                    <input type="text" id="penilaian-manual-kelas" class="premium-input w-full text-sm sm:text-base" placeholder="Contoh: 8B">
                                                </div>
                                            </div>
                                            <div class="pt-8 border-t-2 border-slate-200 mb-8">
                                                <label class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Soal Esai</label>
                                                <textarea id="penilaian-manual-soal-teks" rows="4" class="premium-textarea w-full text-sm sm:text-base" placeholder="Ketik atau tempel soal di sini..."></textarea>
                                            </div>
                                            <div class="pt-8 border-t-2 border-slate-200 mb-8">
                                                <label class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Jawaban Esai Siswa</label>
                                                <textarea id="penilaian-manual-jawaban-teks" rows="6" class="premium-textarea w-full text-sm sm:text-base mb-4" placeholder="Ketik atau tempel jawaban siswa di sini..."></textarea>
                                                ${createPremiumFileUploaderHTML('penilaian-manual-jawaban', 'Upload Jawaban Esai (Gambar)', 'Alternatif: upload foto jawaban siswa')}
                                            </div>
                                            <div class="pt-8 border-t-2 border-slate-200 mb-8">
                                                <label for="penilaian-manual-kunci" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Kunci Jawaban / Pedoman Penilaian</label>
                                                <textarea id="penilaian-manual-kunci" rows="5" class="premium-textarea w-full text-sm sm:text-base" placeholder="Masukkan poin-poin penting yang harus ada dalam jawaban, kriteria penilaian, atau rubrik..."></textarea>
                                            </div>
                                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-8">
                                                <div>
                                                    <label for="penilaian-manual-rubrik" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Rubrik Tambahan (Opsional)</label>
                                                    <input type="text" id="penilaian-manual-rubrik" class="premium-input w-full text-sm sm:text-base" placeholder="Contoh: Ketepatan 60%, Penalaran 40%">
                                                </div>
                                                <div>
                                                    <label for="penilaian-manual-skala" class="block text-base sm:text-lg font-semibold text-slate-700 mb-4">Skala Nilai</label>
                                                    <select id="penilaian-manual-skala" class="premium-select w-full">
                                                        <option>1 - 100</option><option>1 - 10</option><option>A - E</option>
                                                    </select>
                                                </div>
                                            </div>
                                            <button id="btn-generate-penilaian-manual" class="premium-button bg-gradient-to-r from-slate-600 to-slate-800 hover:from-slate-700 hover:to-slate-900 w-full text-base py-3 sm:text-lg">
                                                <i class="fas fa-check-double mr-3"></i> Periksa & Nilai Esai dengan Pedoman
                                            </button>
                                            <div id="penilaian-manual-loader" class="hidden mt-8 flex flex-col items-center">
                                                <div class="premium-loader"></div>
                                                <p class="mt-4 text-slate-600 font-medium">AI sedang menganalisis berdasarkan pedoman Anda...</p>
                                            </div>
                                            <div id="penilaian-manual-hasil" class="mt-12 hidden premium-ai-output"></div>
                                        </div>
                                    </div>
                                </div>
                    `;
                }
            }
            
            // --- Premium Global Setup ---
            const sidebarItems = document.querySelectorAll('.premium-sidebar-item');
            const contentSections = document.querySelectorAll('.content-section');
            const featureCards = document.querySelectorAll('.premium-feature-card');

            function switchTab(targetId) {
                contentSections.forEach(section => section.classList.remove('active'));
                const targetSection = document.getElementById(targetId);
                if (targetSection) {
                    targetSection.classList.add('active');
                }
                sidebarItems.forEach(item => {
                    item.classList.toggle('active', item.dataset.target === targetId);
                });
                if (window.innerWidth < 768) {
                    closeSidebar();
                }
            }

            sidebarItems.forEach(item => {
                item.addEventListener('click', (e) => { 
                    e.preventDefault(); 
                    switchTab(item.dataset.target); 
                });
            });
            
            featureCards.forEach(card => {
                card.addEventListener('click', () => switchTab(card.dataset.target));
            });
            
            document.getElementById('home-link-desktop')?.addEventListener('click', (e) => {
                e.preventDefault();
                switchTab('home');
            });
            document.getElementById('home-link-mobile')?.addEventListener('click', (e) => {
                e.preventDefault();
                switchTab('home');
            });

            // --- Premium Helper Functions ---
            function fileToBase64(file) {
                return new Promise((resolve, reject) => {
                    const reader = new FileReader();
                    reader.readAsDataURL(file);
                    reader.onload = () => resolve({ 
                        base64: reader.result.split(',')[1],
                        mimeType: file.type
                    });
                    reader.onerror = error => reject(error);
                });
            }

            function setupPremiumImageUploader(prefix) {
                const inputId = `${prefix}-gambar`;
                const previewId = `${prefix}-preview`;
                const imgId = `${prefix}-preview-img`;
                const removeBtnId = `${prefix}-remove-img`;

                const input = document.getElementById(inputId);
                const previewContainer = document.getElementById(previewId);
                const previewImg = document.getElementById(imgId);
                const removeBtn = document.getElementById(removeBtnId);

                if (!input || !previewContainer || !previewImg || !removeBtn) {
                    return;
                }

                input.addEventListener('change', function() {
                    if (this.files && this.files[0]) {
                        const reader = new FileReader();
                        reader.onload = (e) => {
                            previewImg.src = e.target.result;
                            previewContainer.classList.remove('hidden');
                        }
                        reader.readAsDataURL(this.files[0]);
                    } else {
                        previewContainer.classList.add('hidden');
                    }
                });

                removeBtn.addEventListener('click', function(e) {
                    e.preventDefault();
                    input.value = ''; 
                    previewImg.src = '';
                    previewContainer.classList.add('hidden');
                });
            }
            
            function initializePremiumTopicSelector(prefix) {
                const jenjangEl = document.getElementById(`${prefix}-jenjang`);
                const kelasEl = document.getElementById(`${prefix}-kelas`);
                const mapelEl = document.getElementById(`${prefix}-mapel`);
                const babEl = document.getElementById(`${prefix}-bab`);
                const topikEl = document.getElementById(`${prefix}-topik`);

                if (!jenjangEl) return;

                jenjangEl.innerHTML = '<option value="">Pilih Jenjang...</option>';
                for (const jenjang in kurikulumData) {
                    jenjangEl.innerHTML += `<option value="${jenjang}">${jenjang}</option>`;
                }

                jenjangEl.addEventListener('change', () => {
                    const selectedJenjang = jenjangEl.value;
                    kelasEl.innerHTML = '<option value="">Pilih Kelas/Tingkat...</option>';
                    mapelEl.innerHTML = '<option value="">Pilih Mapel/Prodi...</option>';
                    babEl.innerHTML = '<option value="">Pilih Bab/Materi...</option>';
                    kelasEl.disabled = true;
                    mapelEl.disabled = true;
                    babEl.disabled = true;
                    topikEl.value = '';

                    if (selectedJenjang) {
                        kelasEl.disabled = false;
                        for (const kelas in kurikulumData[selectedJenjang]) {
                            kelasEl.innerHTML += `<option value="${kelas}">${kelas}</option>`;
                        }
                    }
                });

                kelasEl.addEventListener('change', () => {
                    const selectedJenjang = jenjangEl.value;
                    const selectedKelas = kelasEl.value;
                    mapelEl.innerHTML = '<option value="">Pilih Mapel/Prodi...</option>';
                    babEl.innerHTML = '<option value="">Pilih Bab/Materi...</option>';
                    mapelEl.disabled = true;
                    babEl.disabled = true;
                    topikEl.value = '';
                    
                    if (selectedKelas) {
                        mapelEl.disabled = false;
                        for (const mapel in kurikulumData[selectedJenjang][selectedKelas]) {
                            mapelEl.innerHTML += `<option value="${mapel}">${mapel}</option>`;
                        }
                    }
                });
                
                mapelEl.addEventListener('change', () => {
                    const selectedJenjang = jenjangEl.value;
                    const selectedKelas = kelasEl.value;
                    const selectedMapel = mapelEl.value;
                    babEl.innerHTML = '<option value="">Pilih Bab/Materi...</option>';
                    babEl.disabled = true;
                    topikEl.value = '';

                    if (selectedMapel) {
                        babEl.disabled = false;
                        kurikulumData[selectedJenjang][selectedKelas][selectedMapel].forEach(bab => {
                            babEl.innerHTML += `<option value="${bab}">${bab}</option>`;
                        });
                    }
                });

                babEl.addEventListener('change', () => {
                    if(babEl.value){
                        topikEl.value = `${babEl.value} (${mapelEl.value} - ${kelasEl.value})`;
                    } else {
                        topikEl.value = '';
                    }
                });

                topikEl.addEventListener('input', () => {
                    if (jenjangEl.value !== "") {
                        jenjangEl.value = "";
                        jenjangEl.dispatchEvent(new Event('change'));
                    }
                });
            }

            function renderPremiumAIOutput(rawText, outputElement) {
                outputElement.innerHTML = rawText;

                if (window.renderMathInElement) {
                    try {
                        renderMathInElement(outputElement, {
                            delimiters: [
                                {left: '$$', right: '$$', display: true},
                                {left: '$', right: '$', display: false}
                            ],
                            throwOnError: false
                        });
                    } catch (e) {
                        console.error("KaTeX rendering error:", e);
                    }
                }
            }

            async function callPremiumGeminiApi(promptParts, resultElId, loaderElId) {
                const resultEl = document.getElementById(resultElId);
                const loaderEl = document.getElementById(loaderElId);
                
                resultEl.innerHTML = '';
                resultEl.classList.add('hidden');
                loaderEl.classList.remove('hidden');

                const apiKey = getNextApiKey(); 

                if (!apiKey) {
                    resultEl.innerHTML = `<div class="error-state p-6 rounded-2xl border-2"><strong>Error:</strong> Tidak ada API Key yang tersedia.</div>`;
                    resultEl.classList.remove('hidden');
                    loaderEl.classList.add('hidden');
                    return;
                }

                const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.0-pro:generateContent?key=${apiKey}`;
                const payload = { contents: [{ parts: promptParts }] };

                try {
                    const response = await fetch(apiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    
                    if (!response.ok) {
                        const errorData = await response.json();
                        throw new Error(errorData.error.message || `HTTP error! Status: ${response.status}`);
                    }
                    
                    const result = await response.json();
                    const textResult = result.candidates?.[0]?.content?.parts?.[0]?.text;

                    if (textResult) {
                        renderPremiumAIOutput(textResult, resultEl);
                    } else {
                        throw new Error("Respons dari API tidak valid atau kosong.");
                    }
                } catch (error) {
                    console.error("Error calling Gemini API:", error);
                    resultEl.innerHTML = `<div class="error-state p-6 rounded-2xl border-2"><strong>Error:</strong> ${error.message}</div>`;
                } finally {
                    loaderEl.classList.add('hidden');
                    resultEl.classList.remove('hidden');
                }
            }
            
            // --- Premium Event Listeners ---
            function attachPremiumEventListeners() {
                const latexInstruction = `\n\n**PENTING**: Setiap kali Anda menulis rumus, persamaan, atau ekspresi matematika, WAJIB gunakan format LaTeX. Untuk matematika inline, bungkus dengan satu tanda dolar (contoh: $E=mc^2$). Untuk matematika dalam blok display terpisah, bungkus dengan dua tanda dolar (contoh: $$ y = \\frac{a}{b+c} $$). Ini sangat penting untuk rendering yang benar.`;
                
                document.getElementById('btn-generate-materi')?.addEventListener('click', () => {
                    const topic = document.getElementById('materi-topik').value;
                    const isDifferentiated = document.getElementById('materi-diferensiasi').checked;
                    let prompt = `Anda adalah guru ahli. Buatkan materi ajar lengkap format HTML untuk topik: "${topic}". Gunakan heading (<h2>, <h3>) untuk memisahkan bagian.`;
                    
                    if (isDifferentiated) {
                        prompt += ` Buat juga 3 versi: disederhanakan, standar, dan pengayaan.`;
                    }
                    prompt += latexInstruction;
                    callPremiumGeminiApi([{text: prompt}], 'materi-hasil', 'materi-loader');
                });

                document.getElementById('btn-generate-glosarium')?.addEventListener('click', () => {
                    const text = document.getElementById('glosarium-teks').value;
                    let prompt = `Analisis teks berikut dan identifikasi 5-7 istilah kunci. Untuk setiap istilah, berikan output HTML:\n- <h3> untuk istilah.\n- <p> untuk definisi yang mudah dipahami.\n- <ul><li> berisi contoh kalimat.\n\nTeks: "${text}"`;
                    prompt += latexInstruction;
                    callPremiumGeminiApi([{text: prompt}], 'glosarium-hasil', 'glosarium-loader');
                });

                document.getElementById('btn-generate-konteks')?.addEventListener('click', async () => {
                    const imageFile = document.getElementById('konteks-gambar').files[0];
                    if (!imageFile) { 
                        alert("Silakan unggah sebuah gambar untuk dianalisis."); 
                        return; 
                    }
                    
                    let prompt = `Anda adalah kurator museum dan guru ahli. Analisis gambar ini. Berikan output HTML yang mencakup:\n1. <h2>Deskripsi Detail</h2>\n2. <h2>Poin Diskusi & Pertanyaan HOTS</h2> (gunakan <ol>)\n3. <h2>Fakta Terkait</h2> (gunakan <ul>)`;
                    prompt += latexInstruction;
                    
                    const { base64, mimeType } = await fileToBase64(imageFile);
                    const promptParts = [{ text: prompt }, { inlineData: { mimeType: mimeType, data: base64 } }];
                    callPremiumGeminiApi(promptParts, 'konteks-hasil', 'konteks-loader');
                });

                document.getElementById('btn-generate-soal')?.addEventListener('click', () => {
                    const topic = document.getElementById('soal-topik').value;
                    const type = document.getElementById('soal-tipe').value;
                    const count = document.getElementById('soal-jumlah').value;
                    const withExplanation = document.getElementById('soal-pembahasan').checked;
                    
                    let prompt = `Buatkan ${count} soal tipe "${type}" tentang "${topic}". Sertakan kunci jawaban. Format seluruh output dalam HTML yang rapi menggunakan <ol> untuk soal.`;
                    
                    if (withExplanation) {
                        prompt += " Setelah kunci jawaban, tambahkan bagian 'Pembahasan' yang menjelaskan mengapa jawaban tersebut benar secara rinci untuk setiap soal.";
                    }
                    prompt += latexInstruction;
                    callPremiumGeminiApi([{text: prompt}], 'soal-hasil', 'soal-loader');
                });
                
                document.getElementById('btn-generate-penjawab-soal')?.addEventListener('click', async () => {
                    const questionText = document.getElementById('penjawab-soal-teks').value;
                    const questionImageFile = document.getElementById('penjawab-soal-gambar').files[0];

                    if (!questionText && !questionImageFile) {
                        alert("Silakan masukkan soal dalam bentuk teks atau gambar.");
                        return;
                    }

                    let prompt = `Anda adalah seorang tutor ahli. Jawab dan berikan pembahasan langkah-demi-langkah yang lengkap untuk soal berikut. Format jawaban dalam HTML, gunakan heading dan daftar jika perlu untuk kejelasan.`;
                    prompt += latexInstruction;
                    
                    const promptParts = [{ text: prompt }];

                    if (questionText) {
                        promptParts.push({ text: `Soal (teks): ${questionText}` });
                    }
                    if (questionImageFile) {
                        const { base64, mimeType } = await fileToBase64(questionImageFile);
                        promptParts.push({ inlineData: { mimeType, data: base64 } });
                    }
                    callPremiumGeminiApi(promptParts, 'penjawab-soal-hasil', 'penjawab-soal-loader');
                });

                document.getElementById('btn-generate-proyek')?.addEventListener('click', () => {
                    const theme = document.getElementById('proyek-tema').value;
                    const duration = document.getElementById('proyek-durasi').value;
                    let prompt = `Anda adalah seorang ahli pedagogi dan spesialis Project-Based Learning (PBL). Buatkan draf lengkap rencana proyek (format HTML) dengan detail berikut:\n\n- Tema Utama: "${theme}"\n- Estimasi Durasi: "${duration}"\n\nStruktur output harus mencakup:\n1. <h2>Tujuan Proyek</h2>\n2. <h2>Pembagian Kelompok & Peran</h2>\n3. <h2>Linimasa Proyek</h2>\n4. <h2>Rubrik Penilaian</h2>`;
                    prompt += latexInstruction;
                    callPremiumGeminiApi([{text: prompt}], 'proyek-hasil', 'proyek-loader');
                });

                const activityCards = document.querySelectorAll('.activity-choice-card');
                activityCards.forEach(card => {
                    card.addEventListener('click', () => {
                        const activityType = card.dataset.activityType;
                        const activityTitle = card.dataset.activityTitle;
                        
                        const cardContainer = document.getElementById('aktivitas-card-container');
                        const formContainer = document.getElementById('aktivitas-form-container');

                        cardContainer.classList.add('hidden');

                        const formHTML = `
                                <button id="btn-back-aktivitas" class="mb-6 text-slate-600 hover:text-primary-600 font-semibold flex items-center">
                                    <i class="fas fa-arrow-left mr-2"></i> Kembali Pilih Aktivitas
                                </button>
                                ${createPremiumTopicSelectorHTML('aktivitas', `Rancang Aktivitas: ${activityTitle}`, '', 'Rancang Aktivitas', 'fa-users')}
                        `;
                        
                        formContainer.innerHTML = formHTML;
                        formContainer.classList.remove('hidden');

                        initializePremiumTopicSelector('aktivitas');
                        
                        document.getElementById('btn-back-aktivitas').addEventListener('click', () => {
                            formContainer.classList.add('hidden');
                            cardContainer.classList.remove('hidden');
                            formContainer.innerHTML = '';
                        });
                        
                        const generateBtn = document.getElementById('btn-generate-aktivitas');
                        generateBtn.dataset.activityType = activityType;
                        
                        generateBtn.addEventListener('click', () => {
                            const topic = document.getElementById('aktivitas-topik').value;
                            const selectedActivity = generateBtn.dataset.activityType;
                            
                            let prompt = `Rancang paket materi lengkap (format HTML) untuk aktivitas kelas "${selectedActivity}" dengan topik "${topic}". Sertakan tujuan, persiapan, langkah-langkah, dan materi siswa.`;
                            prompt += latexInstruction;
                            callPremiumGeminiApi([{text: prompt}], 'aktivitas-hasil', 'aktivitas-loader');
                        });
                    });
                });

                document.getElementById('btn-generate-kuis')?.addEventListener('click', () => {
                    const topic = document.getElementById('kuis-topik').value;
                    let prompt = `Buat kuis formatif 10 pertanyaan tentang "${topic}". Campur 5 Pilihan Ganda (tandai jawaban benar dengan <strong>), 3 Benar/Salah, dan 2 Isian Singkat. Format dalam HTML <ol>.`;
                    prompt += latexInstruction;
                    callPremiumGeminiApi([{text: prompt}], 'kuis-hasil', 'kuis-loader');
                });

                document.getElementById('btn-generate-jawaban')?.addEventListener('click', () => {
                    const question = document.getElementById('pertanyaan-siswa').value;
                    let prompt = `Saya guru mendapat pertanyaan dari siswa: "${question}". Berikan 3 opsi cara menjawab (format HTML):\n1. <h3>Penjelasan Sederhana</h3>\n2. <h3>Analogi atau Perumpamaan</h3>\n3. <h3>Ide Demonstrasi Cepat</h3>`;
                    prompt += latexInstruction;
                    callPremiumGeminiApi([{text: prompt}], 'jawaban-hasil', 'jawaban-loader');
                });

                document.getElementById('btn-generate-penilaian-terpadu')?.addEventListener('click', async () => {
                    const answerSheetImageFile = document.getElementById('penilaian-terpadu-gambar').files[0];
                    const answerKeyText = document.getElementById('penilaian-terpadu-kunci-teks').value;
                    const answerKeyImageFile = document.getElementById('penilaian-terpadu-kunci-gambar').files[0];
                    const gradingScale = document.getElementById('penilaian-terpadu-skala').value;

                    if (!answerSheetImageFile) {
                        alert("Mohon unggah gambar lembar jawaban siswa.");
                        return;
                    }

                    const { base64, mimeType } = await fileToBase64(answerSheetImageFile);
                    let prompt;
                    const promptParts = [];

                    if (answerKeyText || answerKeyImageFile) {
                         prompt = `Anda adalah AI pemeriksa ulangan. Tugas Anda adalah memeriksa lembar jawaban terpadu siswa (gambar 1) dan membandingkannya dengan kunci jawaban yang saya berikan (teks atau gambar 2).
                                  - Skala Penilaian: "${gradingScale}"
                                  
                                  Instruksi: Deteksi nama dan kelas dari lembar jawaban. Cocokkan jawaban siswa (PG dan esai singkat) dengan kunci. Hitung skornya, dan tampilkan laporan penilaian lengkap dalam format HTML.`;
                        promptParts.push({ text: prompt }, { inlineData: { mimeType, data: base64 } });
                        if (answerKeyText) {
                            promptParts.push({ text: `\nKunci Jawaban (teks): \n${answerKeyText}` });
                        }
                        if(answerKeyImageFile) {
                            const keyImg = await fileToBase64(answerKeyImageFile);
                            promptParts.push({ text: "\nKunci Jawaban (gambar):" }, { inlineData: { mimeType: keyImg.mimeType, data: keyImg.base64 } });
                        }
                    } else {
                         prompt = `Anda adalah AI penilai super canggih. Tugas Anda adalah memeriksa lembar jawaban terpadu siswa dari gambar berikut secara otomatis. Lakukan langkah-langkah ini:
                                  1. Analisis gambar untuk mendeteksi nama dan kelas siswa.
                                  2. Identifikasi semua soal (PG, esai singkat, dll.) dan jawaban yang diberikan siswa.
                                  3. Gunakan pengetahuan Anda untuk menentukan jawaban yang benar untuk setiap soal.
                                  4. Bandingkan jawaban siswa dengan jawaban yang benar, nilai esai singkat berdasarkan relevansi.
                                  5. Hitung skor total dan berikan nilai akhir berdasarkan skala penilaian: "${gradingScale}".
                                  6. Buat ringkasan penilaian yang jelas dalam format HTML.`;
                        promptParts.push({ text: prompt }, { inlineData: { mimeType, data: base64 } });
                    }

                    promptParts.push({text: `\nFormat output harus mencakup: <h2>Hasil Penilaian Lembar Terpadu</h2>, <h4>Nama: [Nama Siswa], Kelas: [Kelas Siswa]</h4>, <h3>Nilai Akhir: [Nilai Terhitung]</h3>, <h3>Analisis Jawaban:</h3> (tabel nomor soal, jawaban siswa, jawaban benar, status), dan <h3>Umpan Balik</h3>.` + latexInstruction});

                    callPremiumGeminiApi(promptParts, 'penilaian-terpadu-hasil', 'penilaian-terpadu-loader');
                });
                
                document.getElementById('btn-generate-penilaian-manual')?.addEventListener('click', async () => {
                    const studentName = document.getElementById('penilaian-manual-nama').value;
                    const studentClass = document.getElementById('penilaian-manual-kelas').value;
                    const questionText = document.getElementById('penilaian-manual-soal-teks').value;
                    const answerText = document.getElementById('penilaian-manual-jawaban-teks').value;
                    const answerImageFile = document.getElementById('penilaian-manual-jawaban-gambar').files[0];
                    const answerKey = document.getElementById('penilaian-manual-kunci').value;
                    const rubric = document.getElementById('penilaian-manual-rubrik').value;
                    const gradingScale = document.getElementById('penilaian-manual-skala').value;

                    if ((!questionText) || (!answerText && !answerImageFile)) {
                        alert("Mohon lengkapi Soal Esai dan Jawaban Siswa.");
                        return;
                    }

                    let prompt = `Anda adalah asisten penilai guru yang sangat teliti. Tugas Anda adalah menilai jawaban esai siswa berdasarkan kunci jawaban dan kriteria yang diberikan.
                                  - Nama Siswa: "${studentName || 'Tidak disebutkan'}"
                                  - Kelas: "${studentClass || 'Tidak disebutkan'}"
                                  - Kunci Jawaban / Pedoman: "${answerKey}"
                                  - Rubrik Penilaian Tambahan: "${rubric || 'Tidak ada'}"
                                  - Skala Penilaian yang digunakan: "${gradingScale}"
                                  - Soal Esai: "${questionText}"`;
                    
                    const promptParts = [{ text: prompt }];
                    
                    if (answerText) promptParts.push({ text: `\nJawaban Siswa (teks): \n${answerText}` });
                    if (answerImageFile) {
                        const { base64, mimeType } = await fileToBase64(answerImageFile);
                        promptParts.push({ text: "\nJawaban Siswa (gambar):" }, { inlineData: { mimeType, data: base64 } });
                    }

                    promptParts.push({ text: `\nInstruksi Final: Berikan nilai sesuai skala, dan berikan umpan balik konstruktif. Format output dalam HTML yang rapi: <h2>Hasil Penilaian Esai</h2>, <h4>Nama Siswa & Kelas</h4>, <h3>Nilai</h3>, dan <h3>Umpan Balik & Analisis</h3>.` + latexInstruction });

                    callPremiumGeminiApi(promptParts, 'penilaian-manual-hasil', 'penilaian-manual-loader');
                });

                document.getElementById('btn-generate-penilaian-esai-otomatis')?.addEventListener('click', async () => {
                    const questionText = document.getElementById('penilaian-esai-otomatis-soal').value;
                    const answerText = document.getElementById('penilaian-esai-otomatis-jawaban-teks').value;
                    const answerImageFile = document.getElementById('penilaian-esai-otomatis-jawaban-gambar').files[0];
                    const gradingScale = document.getElementById('penilaian-esai-otomatis-skala').value;

                    if (!questionText || (!answerText && !answerImageFile)) {
                        alert("Mohon lengkapi Soal Esai dan Jawaban Siswa.");
                        return;
                    }

                    const prompt = `Anda adalah seorang guru ahli yang menilai esai. Tugas Anda adalah menilai jawaban esai siswa secara otomatis tanpa kunci jawaban.
                                  - Skala Penilaian yang digunakan: "${gradingScale}"
                                  - Soal Esai: "${questionText}"
                                  - Nilai esai ini berdasarkan kriteria: Kejelasan argumen, struktur penulisan, akurasi faktual, dan kedalaman analisis. Coba deteksi nama dan kelas siswa dari gambar/teks jawaban jika ada.`;

                    const promptParts = [{ text: prompt }];

                    if (answerText) promptParts.push({ text: `\nJawaban Siswa (teks): \n${answerText}` });
                    if (answerImageFile) {
                        const { base64, mimeType } = await fileToBase64(answerImageFile);
                        promptParts.push({ text: "\nJawaban Siswa (gambar):" }, { inlineData: { mimeType, data: base64 } });
                    }

                    promptParts.push({ text: `\nInstruksi Final: Berikan nilai sesuai skala, dan umpan balik konstruktif. Format output dalam HTML: <h2>Hasil Penilaian Esai Otomatis</h2>, <h4>Nama Siswa: [Nama terdeteksi], Kelas: [Kelas terdeteksi]</h4>, <h3>Nilai</h3>, dan <h3>Umpan Balik & Analisis</h3>.` + latexInstruction });

                    callPremiumGeminiApi(promptParts, 'penilaian-esai-otomatis-hasil', 'penilaian-esai-otomatis-loader');
                });
                
                document.getElementById('btn-generate-penilaian-otomatis')?.addEventListener('click', async () => {
                    const studentName = document.getElementById('penilaian-otomatis-nama').value;
                    const studentClass = document.getElementById('penilaian-otomatis-kelas').value;
                    const answerSheetImageFile = document.getElementById('penilaian-otomatis-gambar').files[0];
                    const answerKeyText = document.getElementById('penilaian-otomatis-kunci-teks').value;
                    const answerKeyImageFile = document.getElementById('penilaian-otomatis-kunci-gambar').files[0];
                    const gradingScale = document.getElementById('penilaian-otomatis-skala').value;

                    if (!answerSheetImageFile) {
                        alert("Mohon unggah gambar lembar jawaban siswa.");
                        return;
                    }
                    
                    const { base64, mimeType } = await fileToBase64(answerSheetImageFile);
                    let prompt;
                    const promptParts = [];

                    if (answerKeyText || answerKeyImageFile) {
                        // Mode dengan Kunci Jawaban
                        prompt = `Anda adalah AI pemeriksa ulangan. Tugas Anda adalah memeriksa lembar jawaban siswa (gambar 1) dan membandingkannya dengan kunci jawaban yang saya berikan (teks atau gambar 2).
                                  - Skala Penilaian: "${gradingScale}"
                                  - Nama Siswa (jika ada di input): "${studentName}"
                                  - Kelas (jika ada di input): "${studentClass}"
                                  
                                  Instruksi: Cocokkan jawaban siswa dengan kunci. Hitung skornya, dan tampilkan laporan penilaian lengkap dalam format HTML. Jika nama/kelas tidak diisi, coba deteksi dari gambar lembar jawaban.`;
                        promptParts.push({ text: prompt }, { inlineData: { mimeType, data: base64 } });
                        if (answerKeyText) {
                            promptParts.push({ text: `\nKunci Jawaban (teks): \n${answerKeyText}` });
                        }
                        if(answerKeyImageFile) {
                            const keyImg = await fileToBase64(answerKeyImageFile);
                            promptParts.push({ text: "\nKunci Jawaban (gambar):" }, { inlineData: { mimeType: keyImg.mimeType, data: keyImg.base64 } });
                        }

                    } else {
                        // Mode Otomatis Penuh
                         prompt = `Anda adalah AI penilai super canggih. Tugas Anda adalah memeriksa lembar jawaban siswa dari gambar berikut secara otomatis. Lakukan langkah-langkah ini:
                                  1. Analisis gambar untuk mengidentifikasi semua soal dan jawaban yang diberikan oleh siswa (perhatikan lingkaran atau tanda centang pada pilihan ganda). Jika ada nama dan kelas, deteksi juga.
                                  2. Gunakan pengetahuan Anda untuk menentukan jawaban yang benar untuk setiap soal.
                                  3. Bandingkan jawaban siswa dengan jawaban yang benar.
                                  4. Hitung jumlah jawaban yang benar dan berikan nilai akhir berdasarkan skala penilaian: "${gradingScale}".
                                  5. Buat ringkasan penilaian yang jelas dalam format HTML.`;
                        promptParts.push({ text: prompt }, { inlineData: { mimeType, data: base64 } });
                    }
                    
                    promptParts.push({text: `\nFormat output harus mencakup: <h2>Hasil Penilaian Otomatis</h2>, <h4>Nama: [Nama Siswa], Kelas: [Kelas Siswa]</h4>, <h3>Nilai Akhir: [Nilai Terhitung]</h3>, <h3>Analisis Jawaban:</h3> (tabel nomor soal, jawaban siswa, jawaban benar, status), dan <h3>Umpan Balik</h3>.` + latexInstruction});

                    callPremiumGeminiApi(promptParts, 'penilaian-otomatis-hasil', 'penilaian-otomatis-loader');
                });
                
                document.getElementById('btn-generate-komunikasi')?.addEventListener('click', () => {
                    const studentName = document.getElementById('komunikasi-nama').value;
                    const purpose = document.getElementById('komunikasi-tujuan').value;
                    const keyPoints = document.getElementById('komunikasi-poin').value;
                    const prompt = `Buatkan draf pesan singkat (email/WA) kepada orang tua dari siswa bernama "${studentName}".\nTujuan: "${purpose}".\nPoin kunci:\n- ${keyPoints.replace(/\n/g, "\n- ")}\n\nGunakan bahasa sopan dan kolaboratif. Format dalam HTML <p> dan <strong>.`;
                    callPremiumGeminiApi([{text: prompt}], 'komunikasi-hasil', 'komunikasi-loader');
                });
                
                document.getElementById('btn-generate-rpp')?.addEventListener('click', () => {
                    const topic = document.getElementById('rpp-topik').value;
                    const duration = document.getElementById('rpp-durasi').value;
                    const objective = document.getElementById('rpp-tujuan').value;
                    let prompt = `Buatkan draf RPP (format HTML) untuk topik: "${topic}". Durasi: ${duration} menit. Tujuan Pembelajaran: "${objective}". Sertakan komponen RPP standar: pendahuluan, inti, dan penutup.`;
                    prompt += latexInstruction;
                    callPremiumGeminiApi([{text: prompt}], 'rpp-hasil', 'rpp-loader');
                });

                document.getElementById('btn-generate-analisis-rpp')?.addEventListener('click', () => {
                    const rppText = document.getElementById('analisis-rpp-teks').value;
                    let prompt = `Anda adalah seorang "coach" pedagogis AI. Analisis draf RPP berikut dan berikan umpan balik konstruktif dalam format HTML. Fokus pada:\n1. <h3>Kesesuaian Asesmen</h3>\n2. <h3>Saran Kegiatan Pembuka</h3>\n3. <h3>Peluang Diferensiasi</h3>\n\nBerikut RPP-nya:\n"${rppText}"`;
                    prompt += latexInstruction;
                    callPremiumGeminiApi([{ text: prompt }], 'analisis-rpp-hasil', 'analisis-rpp-loader');
                });
                
                // Tab system initialization
                function initializePremiumTabLogic(containerId) {
                    const container = document.getElementById(containerId);
                    if (!container) return;

                    const nav = container.querySelector('nav');
                    if (!nav) return;

                    nav.addEventListener('click', (event) => {
                        const button = event.target.closest('.premium-tab-button');
                        if (!button) return;

                        const targetId = button.dataset.target;
                        if (!targetId) return;

                        // Deactivate sibling buttons
                        nav.querySelectorAll('.premium-tab-button').forEach(btn => btn.classList.remove('active'));
                        button.classList.add('active');

                        // Deactivate content panes at the correct level
                        // This looks for direct children of the container, which is correct for all tab structures used.
                        const contentPanes = container.querySelectorAll(`:scope > [class*="tab-content"]`);
                        contentPanes.forEach(pane => {
                            if(pane.id !== targetId) {
                                pane.classList.remove('active')
                            }
                        });
                        
                        // Activate target pane
                        const targetContent = container.querySelector(`#${targetId}`);
                        if (targetContent) {
                            targetContent.classList.add('active');
                        }
                    });
                }
                
                initializePremiumTabLogic('perencana-rpp-tabs-container');
                initializePremiumTabLogic('penilaian-tabs-container');  
                initializePremiumTabLogic('penilaian-esai-nested-tabs-container');
                
                // Initialize all topic selectors
                ['materi', 'soal', 'kuis', 'rpp', 'aktivitas'].forEach(initializePremiumTopicSelector);
                
                // Initialize all image uploaders  
                ['konteks', 'penjawab-soal', 'penilaian-terpadu', 'penilaian-terpadu-kunci', 'penilaian-otomatis', 'penilaian-otomatis-kunci', 'penilaian-esai-otomatis-jawaban', 'penilaian-manual-jawaban'].forEach(setupPremiumImageUploader);
            }
            
            // --- INITIALIZE PREMIUM APP ---
            buildPremiumUI();
            attachPremiumEventListeners(); // This will attach all event listeners for the premium UI
        });
    </script>
</body>
</html>
